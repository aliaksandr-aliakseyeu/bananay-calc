# ðŸŒ Bananay Delivery Calculator - ÐžÐ±Ð·Ð¾Ñ€ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°

## ðŸ“‹ Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð°Ð½Ð¸Ðµ

- [Ð¢ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ð¸](#technologies)
- [Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ð¼Ð¾Ð´ÐµÐ»Ð¸](#database-and-models)
- [Ð¡ÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…](#import-scripts)
- [API Endpoints](#api-endpoints)
- [Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ Ð³ÐµÐ¾Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸](#geodata)
- [ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° Ð¸ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°](#architecture) _(Ð² Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ)_

---

## ðŸ›  Ð¢ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ð¸ {#technologies}

### Backend Framework
- **[FastAPI](https://fastapi.tiangolo.com/)** `0.115.0` - ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹, Ð²Ñ‹ÑÐ¾ÐºÐ¾Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð²ÐµÐ±-Ñ„Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€Ðº Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ API
  - ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ OpenAPI (Swagger) Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ð¸
  - ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ð¸ Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð²
  - Async/await support Ð¸Ð· ÐºÐ¾Ñ€Ð¾Ð±ÐºÐ¸
  - Ð’Ñ‹ÑÐ¾ÐºÐ°Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ (Ð½Ð° ÑƒÑ€Ð¾Ð²Ð½Ðµ NodeJS Ð¸ Go)

- **[Uvicorn](https://www.uvicorn.org/)** `0.32.0` - ASGI ÑÐµÑ€Ð²ÐµÑ€ Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ° FastAPI Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
  - ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° HTTP/1.1 Ð¸ WebSockets
  - ÐÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²

### Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…
- **[PostgreSQL](https://www.postgresql.org/)** `16` - Ð¼Ð¾Ñ‰Ð½Ð°Ñ Ñ€ÐµÐ»ÑÑ†Ð¸Ð¾Ð½Ð½Ð°Ñ Ð¡Ð£Ð‘Ð”
- **[PostGIS](https://postgis.net/)** `3.4` - Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð³ÐµÐ¾Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸
  - Ð¥Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚ (Ñ‚Ð¾Ñ‡ÐºÐ¸, Ð¿Ð¾Ð»Ð¸Ð³Ð¾Ð½Ñ‹)
  - ÐŸÑ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð¸Ð½Ð´ÐµÐºÑÑ‹ Ð´Ð»Ñ Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð¿Ð¾Ð¸ÑÐºÐ°
  - Ð“ÐµÐ¾Ð¼ÐµÑ‚Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ (Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð²Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ Ð² Ð¿Ð¾Ð»Ð¸Ð³Ð¾Ð½)
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð¾Ð±Ñ€Ð°Ð· `postgis/postgis:16-3.4`

### ORM Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ð° Ñ Ð‘Ð”
- **[SQLAlchemy](https://www.sqlalchemy.org/)** `2.0.44` - ORM Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹ async/await
  - Async Ñ€ÐµÐ¶Ð¸Ð¼ Ñ‡ÐµÑ€ÐµÐ· AsyncSession
  - Ð”ÐµÐºÐ»Ð°Ñ€Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ ÑÑ‚Ð¸Ð»ÑŒ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹
  - ÐœÐ¾Ñ‰Ð½Ñ‹Ð¹ query builder

- **[GeoAlchemy2](https://geoalchemy-2.readthedocs.io/)** `0.18.0` - Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ðµ SQLAlchemy Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ PostGIS
  - Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ PostGIS Ñ‚Ð¸Ð¿Ð¾Ð² Ð² SQLAlchemy Ð¼Ð¾Ð´ÐµÐ»Ð¸
  - Ð“ÐµÐ¾Ð¼ÐµÑ‚Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸ Ð½Ð° ÑƒÑ€Ð¾Ð²Ð½Ðµ ORM

- **[Asyncpg](https://github.com/MagicStack/asyncpg)** `0.30.0` - Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¹ Ð´Ñ€Ð°Ð¹Ð²ÐµÑ€ Ð´Ð»Ñ PostgreSQL
  - Ð¡Ð°Ð¼Ñ‹Ð¹ Ð±Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ Ð´Ñ€Ð°Ð¹Ð²ÐµÑ€ Ð´Ð»Ñ Python
  - ÐÐ°Ñ‚Ð¸Ð²Ð½Ð°Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° async/await

- **[Psycopg2-binary](https://www.psycopg.org/)** `2.9.11` - ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ñ‹Ð¹ Ð´Ñ€Ð°Ð¹Ð²ÐµÑ€ Ð´Ð»Ñ PostgreSQL
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Alembic Ð´Ð»Ñ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¹

### ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸ Ð‘Ð”
- **[Alembic](https://alembic.sqlalchemy.org/)** `1.17.1` - Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ Ð´Ð»Ñ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¹ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…
  - ÐÐ²Ñ‚Ð¾Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¹ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹
  - Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð²ÐµÑ€ÑÐ¸Ð¹ ÑÑ…ÐµÐ¼Ñ‹ Ð‘Ð”
  - Rollback Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸

### Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…
- **[Pydantic](https://docs.pydantic.dev/)** `2.x` - Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº
  - ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð²Ñ…Ð¾Ð´Ð½Ñ‹Ñ…/Ð²Ñ‹Ñ…Ð¾Ð´Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ…
  - Ð¡ÐµÑ€Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ/Ð´ÐµÑÐµÑ€Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ JSON
  - Type hints Ð¸ IDE autocomplete

- **[Pydantic-settings](https://docs.pydantic.dev/latest/concepts/pydantic_settings/)** `2.12.0` - ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸ÐµÐ¹
  - Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº Ð¸Ð· .env Ñ„Ð°Ð¹Ð»Ð¾Ð²
  - Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ

### Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ Ð³ÐµÐ¾Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸ Ð¸ Ð²Ð½ÐµÑˆÐ½Ð¸Ð¼Ð¸ API
- **[Shapely](https://shapely.readthedocs.io/)** `2.1.2` - Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐºÐ° Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð³ÐµÐ¾Ð¼ÐµÑ‚Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼Ð¸ Ð¾Ð±ÑŠÐµÐºÑ‚Ð°Ð¼Ð¸
  - ÐŸÑ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸Ðµ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚
  - Ð“ÐµÐ¾Ð¼ÐµÑ‚Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¸

- **[HTTPX](https://www.python-httpx.org/)** `0.27.0` - async HTTP ÐºÐ»Ð¸ÐµÐ½Ñ‚
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² Ðº Ð²Ð½ÐµÑˆÐ½Ð¸Ð¼ API Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¸Ð·Ð°Ñ†Ð¸Ð¸
  - ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° timeout Ð¸ retry

- **[OpenRouteService API](https://openrouteservice.org/)** - Ñ€Ð°ÑÑ‡ÐµÑ‚ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¾Ð² Ð¼ÐµÐ¶Ð´Ñƒ Ñ‚Ð¾Ñ‡ÐºÐ°Ð¼Ð¸
  - Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ñ‹Ð¹ Ñ‚Ð°Ñ€Ð¸Ñ„: 2000 Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²/Ð´ÐµÐ½ÑŒ
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð² ÐºÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€Ðµ Ð´Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð¾Ñ‚ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ° Ð´Ð¾ Ð Ð¦
  - ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð° Google Maps Directions API

- **[Yandex Geocoder API](https://yandex.ru/dev/geocode/)** - Ð³ÐµÐ¾ÐºÐ¾Ð´Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ (Ð°Ð´Ñ€ÐµÑ â†’ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚Ñ‹)
  - Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ñ‹Ð¹ Ñ‚Ð°Ñ€Ð¸Ñ„: Ð´Ð¾ 1000 Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²/Ð´ÐµÐ½ÑŒ
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð² ÑÐºÑ€Ð¸Ð¿Ñ‚Ðµ `seed_distribution_centers.py` Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ñ†ÐµÐ½Ñ‚Ñ€Ð¾Ð² Ð¿Ð¾ Ð¸Ñ… Ð°Ð´Ñ€ÐµÑÐ°Ð¼
  - Ð¢Ð¾Ñ‡Ð½Ñ‹Ðµ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚Ñ‹ Ð´Ð»Ñ Ð°Ð´Ñ€ÐµÑÐ¾Ð² Ð² Ð Ð¾ÑÑÐ¸Ð¸

- **[Yandex Router API](https://yandex.ru/dev/routing/)** - Ñ€Ð°ÑÑ‡ÐµÑ‚ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¾Ð² (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)
  - ÐŸÐ»Ð°Ñ‚Ð½Ñ‹Ð¹ ÑÐµÑ€Ð²Ð¸Ñ
  - ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð° OpenRouteService Ð´Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¹
  - Ð‘Ð¾Ð»ÐµÐµ Ñ‚Ð¾Ñ‡Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ Ð´Ð¾Ñ€Ð¾Ð³ Ð² Ð Ð¾ÑÑÐ¸Ð¸

### Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸
- **[OpenPyXL](https://openpyxl.readthedocs.io/)** `3.1.5` - Ñ‡Ñ‚ÐµÐ½Ð¸Ðµ/Ð·Ð°Ð¿Ð¸ÑÑŒ Excel Ñ„Ð°Ð¹Ð»Ð¾Ð²
  - Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚ Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð¸Ð· Excel
  - ÐŸÐ°Ñ€ÑÐ¸Ð½Ð³ Ð°Ð´Ñ€ÐµÑÐ¾Ð² Ð¸ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚

- **[tqdm](https://github.com/tqdm/tqdm)** `4.67.1` - progress bar Ð´Ð»Ñ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð² Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð°
  - Ð’Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…

### Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸
- **[Poetry](https://python-poetry.org/)** `2.0+` - ÑƒÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÑÐ¼Ð¸ Ð¸ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¼ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸ÐµÐ¼
  - Ð˜Ð·Ð¾Ð»ÑÑ†Ð¸Ñ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
  - Lock Ñ„Ð°Ð¹Ð» Ð´Ð»Ñ Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ

- **[Python-dotenv](https://github.com/theskumar/python-dotenv)** `1.2.1` - Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° .env Ñ„Ð°Ð¹Ð»Ð¾Ð²

### Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ
- **[pytest](https://docs.pytest.org/)** `8.0.0` - Ñ„Ñ€ÐµÐ¹Ð¼Ð²Ð¾Ñ€Ðº Ð´Ð»Ñ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
- **[pytest-asyncio](https://github.com/pytest-dev/pytest-asyncio)** `0.24.0` - Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° async Ñ‚ÐµÑÑ‚Ð¾Ð²
- **[pytest-cov](https://pytest-cov.readthedocs.io/)** `6.0.0` - Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸Ðµ ÐºÐ¾Ð´Ð° Ñ‚ÐµÑÑ‚Ð°Ð¼Ð¸

### ÐšÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¸Ð·Ð°Ñ†Ð¸Ñ
- **[Docker](https://www.docker.com/)** - ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ
- **[Docker Compose](https://docs.docker.com/compose/)** - Ð¾Ñ€ÐºÐµÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¾Ð²
  - PostgreSQL Ñ PostGIS
  - API Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ
  - Ð˜Ð·Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð°Ñ ÑÐµÑ‚ÑŒ

### Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹
- **[geojson.io](https://geojson.io/)** - Ð²ÐµÐ±-Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð¸ Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ GeoJSON
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð»ÑÑ Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð¿Ð¾Ð»Ð¸Ð³Ð¾Ð½Ð¾Ð² ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸
  - Ð’Ð¸Ð·ÑƒÐ°Ð»ÑŒÐ½Ð¾Ðµ Ñ€Ð¸ÑÐ¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ð±Ð»Ð°ÑÑ‚ÐµÐ¹ Ð½Ð° ÐºÐ°Ñ€Ñ‚Ðµ
  - Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ GeoJSON
  - **Ð¤Ð°Ð¹Ð» Ñ ÑÐµÐºÑ‚Ð¾Ñ€Ð°Ð¼Ð¸:** [`ÑÐµÐºÑ‚Ð¾Ñ€Ð°.json`](./ÑÐµÐºÑ‚Ð¾Ñ€Ð°.json) - ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ Ð²ÑÐµ Ð¿Ð¾Ð»Ð¸Ð³Ð¾Ð½Ñ‹ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð´Ð»Ñ ÐšÑ€Ð°ÑÐ½Ð¾Ð´Ð°Ñ€ÑÐºÐ¾Ð³Ð¾ ÐºÑ€Ð°Ñ

### Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ
- **Python** `>=3.11, <4.0`
- **PostgreSQL** `16+` Ñ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸ÐµÐ¼ **PostGIS** `3.4+`

---

## ðŸ—‚ Ð’ÐµÑ€ÑÐ¸Ð¸ Ñ‚ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ð¹

| Ð¢ÐµÑ…Ð½Ð¾Ð»Ð¾Ð³Ð¸Ñ | Ð’ÐµÑ€ÑÐ¸Ñ | ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ |
|-----------|--------|------------|
| Python | 3.11+ | Ð¯Ð·Ñ‹Ðº Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ |
| FastAPI | 0.115.0 | Web framework |
| SQLAlchemy | 2.0.44 | ORM |
| GeoAlchemy2 | 0.18.0 | PostGIS Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ |
| PostgreSQL | 16 | Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… |
| PostGIS | 3.4 | Ð“ÐµÐ¾Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ðµ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ðµ |
| Alembic | 1.17.1 | ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸ Ð‘Ð” |
| Pydantic | 2.x | Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… |
| Uvicorn | 0.32.0 | ASGI ÑÐµÑ€Ð²ÐµÑ€ |
| Docker | latest | ÐšÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ð¸Ð·Ð°Ñ†Ð¸Ñ |

---

## ðŸ—„ Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸ Ð¼Ð¾Ð´ÐµÐ»Ð¸ {#database-and-models}

### ÐžÐ±Ð·Ð¾Ñ€ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ Ð‘Ð”

ÐŸÑ€Ð¾ÐµÐºÑ‚ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ **PostgreSQL 16** Ñ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸ÐµÐ¼ **PostGIS 3.4** Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð³ÐµÐ¾Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸. Ð‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… ÑÐ¿Ñ€Ð¾ÐµÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð° Ð´Ð»Ñ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¾ Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð°Ñ…, Ñ‚Ð¾Ñ‡ÐºÐ°Ñ… Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸, ÑÐµÐºÑ‚Ð¾Ñ€Ð°Ñ…, Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ñ… Ð¸ Ñ‚Ð°Ñ€Ð¸Ñ„Ð°Ñ… Ð´Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸.

### Ð¡Ñ…ÐµÐ¼Ð° Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…

#### ðŸŒ Ð“ÐµÐ¾Ð³Ñ€Ð°Ñ„Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¸ÐµÑ€Ð°Ñ€Ñ…Ð¸Ñ

```
countries (Ð¡Ñ‚Ñ€Ð°Ð½Ñ‹)
    â†“
regions (Ð ÐµÐ³Ð¸Ð¾Ð½Ñ‹/ÑÑƒÐ±ÑŠÐµÐºÑ‚Ñ‹ Ð Ð¤)
    â†“
settlements (ÐÐ°ÑÐµÐ»ÐµÐ½Ð½Ñ‹Ðµ Ð¿ÑƒÐ½ÐºÑ‚Ñ‹)
    â†“
districts (Ð Ð°Ð¹Ð¾Ð½Ñ‹ Ð½Ð°ÑÐµÐ»ÐµÐ½Ð½Ñ‹Ñ… Ð¿ÑƒÐ½ÐºÑ‚Ð¾Ð²) [Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾]
    â†“
delivery_points (Ð¢Ð¾Ñ‡ÐºÐ¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸)
```

#### ðŸ“Š ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹

##### 1ï¸âƒ£ **countries** - Ð¡Ñ‚Ñ€Ð°Ð½Ñ‹
| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| id | INTEGER | PRIMARY KEY |
| name | VARCHAR(100) | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÑÑ‚Ñ€Ð°Ð½Ñ‹ (ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ) |
| code | VARCHAR(2) | ISO ÐºÐ¾Ð´ ÑÑ‚Ñ€Ð°Ð½Ñ‹ (ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ) |

**Ð¡Ð²ÑÐ·Ð¸:**
- `1 â†’ Many` regions

---

##### 2ï¸âƒ£ **regions** - Ð ÐµÐ³Ð¸Ð¾Ð½Ñ‹ (ÑÑƒÐ±ÑŠÐµÐºÑ‚Ñ‹ Ð Ð¤)
| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| id | INTEGER | PRIMARY KEY |
| country_id | INTEGER | FK â†’ countries.id |
| name | VARCHAR(200) | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð° |
| type | ENUM | Ð¢Ð¸Ð¿ Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð° (ÐºÑ€Ð°Ð¹, Ð¾Ð±Ð»Ð°ÑÑ‚ÑŒ, Ñ€ÐµÑÐ¿ÑƒÐ±Ð»Ð¸ÐºÐ° Ð¸ Ñ‚.Ð´.) |

**Ð¡Ð²ÑÐ·Ð¸:**
- `Many â†’ 1` countries
- `1 â†’ Many` settlements
- `1 â†’ Many` sectors
- `1 â†’ Many` distribution_centers
- `1 â†’ 1` region_pricing (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)

**Enum RegionType:**
- ÐºÑ€Ð°Ð¹
- Ð¾Ð±Ð»Ð°ÑÑ‚ÑŒ
- Ñ€ÐµÑÐ¿ÑƒÐ±Ð»Ð¸ÐºÐ°
- Ð°Ð²Ñ‚Ð¾Ð½Ð¾Ð¼Ð½Ð°Ñ Ð¾Ð±Ð»Ð°ÑÑ‚ÑŒ
- Ð°Ð²Ñ‚Ð¾Ð½Ð¾Ð¼Ð½Ñ‹Ð¹ Ð¾ÐºÑ€ÑƒÐ³
- Ð³Ð¾Ñ€Ð¾Ð´ Ñ„ÐµÐ´ÐµÑ€Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ

---

##### 3ï¸âƒ£ **region_pricing** - Ð¢Ð°Ñ€Ð¸Ñ„Ñ‹ Ð¸ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° Ð´Ð»Ñ Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð°
| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| id | INTEGER | PRIMARY KEY |
| region_id | INTEGER | FK â†’ regions.id (UNIQUE) |
| **Ð¢Ð°Ñ€Ð¸Ñ„Ñ‹ Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»Ñ** |
| driver_hourly_rate | NUMERIC(10,2) | Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ 1 Ñ‡Ð°ÑÐ° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»Ñ, Ñ€ÑƒÐ±. |
| planned_work_hours | NUMERIC(10,2) | Ð§Ð°ÑÐ¾Ð² Ð½Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð¿Ð¾ Ð¿Ð»Ð°Ð½Ñƒ |
| **ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ñ‚Ñ€Ð°Ð½ÑÐ¿Ð¾Ñ€Ñ‚Ð°** |
| fuel_price_per_liter | NUMERIC(10,2) | Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð±ÐµÐ½Ð·Ð¸Ð½Ð°, Ñ€ÑƒÐ±/Ð» |
| fuel_consumption_per_100km | NUMERIC(10,2) | Ð Ð°ÑÑ…Ð¾Ð´ Ð±ÐµÐ½Ð·Ð¸Ð½Ð°, Ð»/100ÐºÐ¼ |
| depreciation_coefficient | NUMERIC(10,4) | ÐšÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚ Ð°Ð¼Ð¾Ñ€Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð°Ð²Ñ‚Ð¾ |
| **Ð¢Ð°Ñ€Ð¸Ñ„Ñ‹ Ð Ð¦** |
| warehouse_processing_per_kg | NUMERIC(10,2) | Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸ 1 ÐºÐ³ Ð½Ð° Ð Ð¦, Ñ€ÑƒÐ±. |
| service_fee_per_kg | NUMERIC(10,2) | Ð¡ÐµÑ€Ð²Ð¸ÑÐ½Ñ‹Ð¹ ÑÐ±Ð¾Ñ€ 1 ÐºÐ³ (Ð²Ñ‹Ñ€ÑƒÑ‡ÐºÐ° ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸), Ñ€ÑƒÐ±. |
| delivery_point_cost | NUMERIC(10,2) | Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð¾Ð´Ð½Ð¾Ð¹ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸, Ñ€ÑƒÐ±. |
| standard_trip_weight | NUMERIC(10,2) | Ð¡Ñ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð½Ñ‹Ð¹ Ð²ÐµÑ Ð³Ñ€ÑƒÐ·Ð° Ð² Ñ€ÐµÐ¹ÑÐµ, ÐºÐ³ |
| **Ð­Ñ‚Ð°Ð»Ð¾Ð½Ð½Ð°Ñ ÐºÐ¾Ñ€Ð¾Ð±ÐºÐ°** |
| standard_box_length | INTEGER | Ð”Ð»Ð¸Ð½Ð°, ÑÐ¼ |
| standard_box_width | INTEGER | Ð¨Ð¸Ñ€Ð¸Ð½Ð°, ÑÐ¼ |
| standard_box_height | INTEGER | Ð’Ñ‹ÑÐ¾Ñ‚Ð°, ÑÐ¼ |
| standard_box_max_weight | NUMERIC(10,2) | ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð²ÐµÑ, ÐºÐ³ |
| **ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ ÑÐºÐ¸Ð´Ð¾Ðº** |
| min_points_for_discount | INTEGER | ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ ÑÐºÐ¸Ð´ÐºÐ¸ |
| discount_step_points | INTEGER | Ð¨Ð°Ð³ Ð¿Ñ€Ð¸Ñ€Ð¾ÑÑ‚Ð° ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ |
| initial_discount_percent | NUMERIC(5,2) | Ð¡Ñ‚Ð°Ñ€Ñ‚Ð¾Ð²Ð°Ñ ÑÐºÐ¸Ð´ÐºÐ°, % |
| discount_step_percent | NUMERIC(5,2) | Ð¨Ð°Ð³ Ð¿Ñ€Ð¸Ñ€Ð¾ÑÑ‚Ð° ÑÐºÐ¸Ð´ÐºÐ¸, % |

**Ð¡Ð²ÑÐ·Ð¸:**
- `1 â†’ 1` regions

---

##### 4ï¸âƒ£ **settlements** - ÐÐ°ÑÐµÐ»ÐµÐ½Ð½Ñ‹Ðµ Ð¿ÑƒÐ½ÐºÑ‚Ñ‹
| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| id | INTEGER | PRIMARY KEY |
| region_id | INTEGER | FK â†’ regions.id |
| name | VARCHAR(200) | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð½Ð°ÑÐµÐ»ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¿ÑƒÐ½ÐºÑ‚Ð° |
| type | ENUM | Ð¢Ð¸Ð¿ (Ð³Ð¾Ñ€Ð¾Ð´, ÑÐµÐ»Ð¾, Ð´ÐµÑ€ÐµÐ²Ð½Ñ Ð¸ Ñ‚.Ð´.) |
| postal_code | INTEGER | ÐŸÐ¾Ñ‡Ñ‚Ð¾Ð²Ñ‹Ð¹ Ð¸Ð½Ð´ÐµÐºÑ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) |
| location | POINT | PostGIS - ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚Ñ‹ Ñ†ÐµÐ½Ñ‚Ñ€Ð° (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) |

**Ð¡Ð²ÑÐ·Ð¸:**
- `Many â†’ 1` regions
- `1 â†’ Many` districts
- `1 â†’ Many` delivery_points

**Enum SettlementType:**
- Ð³Ð¾Ñ€Ð¾Ð´
- Ð¿Ð³Ñ‚ (Ð¿Ð¾ÑÐµÐ»Ð¾Ðº Ð³Ð¾Ñ€Ð¾Ð´ÑÐºÐ¾Ð³Ð¾ Ñ‚Ð¸Ð¿Ð°)
- ÑÐµÐ»Ð¾
- Ð´ÐµÑ€ÐµÐ²Ð½Ñ
- Ð¿Ð¾ÑÐµÐ»Ð¾Ðº
- ÑÑ‚Ð°Ð½Ð¸Ñ†Ð°
- Ñ…ÑƒÑ‚Ð¾Ñ€
- Ð°ÑƒÐ»

---

##### 5ï¸âƒ£ **districts** - Ð Ð°Ð¹Ð¾Ð½Ñ‹ Ð½Ð°ÑÐµÐ»ÐµÐ½Ð½Ñ‹Ñ… Ð¿ÑƒÐ½ÐºÑ‚Ð¾Ð²
| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| id | INTEGER | PRIMARY KEY |
| settlement_id | INTEGER | FK â†’ settlements.id |
| name | VARCHAR(200) | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ€Ð°Ð¹Ð¾Ð½Ð° |
| boundary | POLYGON | PostGIS - Ð³Ñ€Ð°Ð½Ð¸Ñ†Ð° Ñ€Ð°Ð¹Ð¾Ð½Ð° (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) |

**Ð¡Ð²ÑÐ·Ð¸:**
- `Many â†’ 1` settlements
- `1 â†’ Many` delivery_points (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)

---

##### 6ï¸âƒ£ **distribution_centers** - Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ†ÐµÐ½Ñ‚Ñ€Ñ‹ (Ð Ð¦)
| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| id | INTEGER | PRIMARY KEY |
| region_id | INTEGER | FK â†’ regions.id |
| name | VARCHAR(200) | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð Ð¦ |
| location | POINT | PostGIS - ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚Ñ‹ Ð Ð¦ (Ñ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¼ Ð¸Ð½Ð´ÐµÐºÑÐ¾Ð¼) |
| address | TEXT | ÐÐ´Ñ€ÐµÑ Ð Ð¦ (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) |
| is_active | BOOLEAN | ÐÐºÑ‚Ð¸Ð²ÐµÐ½ Ð»Ð¸ Ð Ð¦ (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ true) |

**Ð¡Ð²ÑÐ·Ð¸:**
- `Many â†’ 1` regions

**Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ:**
- ÐšÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ñ‚ Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ð¹ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ð¹ Ð Ð¦ Ðº Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÑƒ
- Ð Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð´Ð¾ Ð Ð¦ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð² Ñ€Ð°ÑÑ‡ÐµÑ‚Ðµ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸

---

##### 7ï¸âƒ£ **sectors** - Ð¡ÐµÐºÑ‚Ð¾Ñ€Ñ‹ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸
| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| id | INTEGER | PRIMARY KEY |
| region_id | INTEGER | FK â†’ regions.id |
| name | VARCHAR(200) | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÑÐµÐºÑ‚Ð¾Ñ€Ð° (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) |
| description | TEXT | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ ÑÐµÐºÑ‚Ð¾Ñ€Ð° (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) |
| boundary | POLYGON | PostGIS - Ð³Ñ€Ð°Ð½Ð¸Ñ†Ð° ÑÐµÐºÑ‚Ð¾Ñ€Ð° (Ñ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¼ Ð¸Ð½Ð´ÐµÐºÑÐ¾Ð¼) |

**Ð¡Ð²ÑÐ·Ð¸:**
- `Many â†’ 1` regions

**Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ:**
- Ð¡ÐµÐºÑ‚Ð¾Ñ€Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ Ð´Ð»Ñ Ð³Ñ€ÑƒÐ¿Ð¿Ð¸Ñ€Ð¾Ð²ÐºÐ¸ Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸
- ÐšÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ Ð¿Ð¾Ð¿Ð°Ð´Ð°Ð½Ð¸Ðµ Ñ‚Ð¾Ñ‡ÐµÐº Ð² ÑÐµÐºÑ‚Ð¾Ñ€Ñ‹ Ñ‡ÐµÑ€ÐµÐ· `ST_Within`
- ÐšÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ð²Ð»Ð¸ÑÐµÑ‚ Ð½Ð° Ð¸Ñ‚Ð¾Ð³Ð¾Ð²ÑƒÑŽ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸

**Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð²:**
- ÐŸÐ¾Ð»Ð¸Ð³Ð¾Ð½Ñ‹ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ Ñ‡ÐµÑ€ÐµÐ· [geojson.io](https://geojson.io/)
- Ð”Ð°Ð½Ð½Ñ‹Ðµ Ñ…Ñ€Ð°Ð½ÑÑ‚ÑÑ Ð² Ñ„Ð°Ð¹Ð»Ðµ [`ÑÐµÐºÑ‚Ð¾Ñ€Ð°.json`](./ÑÐµÐºÑ‚Ð¾Ñ€Ð°.json)
- Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚ Ñ‡ÐµÑ€ÐµÐ· ÑÐºÑ€Ð¸Ð¿Ñ‚ `import_sectors.py`

---

##### 8ï¸âƒ£ **delivery_points** - Ð¢Ð¾Ñ‡ÐºÐ¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸
| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| id | INTEGER | PRIMARY KEY |
| name | VARCHAR(255) | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ |
| name_normalized | TEXT | ÐÐ¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ð¾Ðµ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ (Ð´Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ°) |
| type | VARCHAR(100) | Ð¢Ð¸Ð¿ Ñ‚Ð¾Ñ‡ÐºÐ¸ (Ð¼Ð°Ð³Ð°Ð·Ð¸Ð½, Ð¿Ð¾ÑÑ‚Ð°Ð¼Ð°Ñ‚ Ð¸ Ñ‚.Ð´.) |
| title | TEXT | Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº / Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ðµ Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
| settlement_id | INTEGER | FK â†’ settlements.id |
| district_id | INTEGER | FK â†’ districts.id (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) |
| address | TEXT | ÐÐ´Ñ€ÐµÑ |
| address_comment | TEXT | ÐšÐ¾Ð¼Ð¼ÐµÐ½Ñ‚Ð°Ñ€Ð¸Ð¹ Ðº Ð°Ð´Ñ€ÐµÑÑƒ |
| landmark | VARCHAR(255) | ÐžÑ€Ð¸ÐµÐ½Ñ‚Ð¸Ñ€ |
| location | POINT | PostGIS - ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚Ñ‹ (Ñ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¼ Ð¸Ð½Ð´ÐµÐºÑÐ¾Ð¼) |
| category_id | INTEGER | FK â†’ categories.id (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) |
| subcategory_id | INTEGER | FK â†’ subcategories.id (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾) |
| **ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹ (MVP - Ð² Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ðµ)** |
| phone | TEXT | Ð¢ÐµÐ»ÐµÑ„Ð¾Ð½(Ñ‹) - Ð¼Ð¾Ð¶ÐµÑ‚ ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ |
| mobile | TEXT | ÐœÐ¾Ð±Ð¸Ð»ÑŒÐ½Ñ‹Ð¹(Ðµ) - Ð¼Ð¾Ð¶ÐµÑ‚ ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ |
| email | TEXT | Email(Ñ‹) - Ð¼Ð¾Ð¶ÐµÑ‚ ÑÐ¾Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ |
| **Ð Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ (MVP - ÐºÐ°Ðº Ñ‚ÐµÐºÑÑ‚)** |
| schedule | TEXT | Ð Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ð² Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ |
| **Ð¡Ð»ÑƒÐ¶ÐµÐ±Ð½Ñ‹Ðµ Ð¿Ð¾Ð»Ñ** |
| is_active | BOOLEAN | ÐÐºÑ‚Ð¸Ð²Ð½Ð° Ð»Ð¸ Ñ‚Ð¾Ñ‡ÐºÐ° (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ true) |
| created_at | TIMESTAMP | Ð”Ð°Ñ‚Ð° ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ (Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸) |
| updated_at | TIMESTAMP | Ð”Ð°Ñ‚Ð° Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ (Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸) |

**Ð¡Ð²ÑÐ·Ð¸:**
- `Many â†’ 1` settlements
- `Many â†’ 1` districts (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)
- `Many â†’ 1` categories (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)
- `Many â†’ 1` subcategories (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)
- `Many â†’ Many` tags (Ñ‡ÐµÑ€ÐµÐ· Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ delivery_point_tags)

**Ð˜Ð½Ð´ÐµÐºÑÑ‹:**
- name (Ð´Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ°)
- name_normalized (Ð´Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ° Ñ Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸ÐµÐ¹)
- location (Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ Ð¸Ð½Ð´ÐµÐºÑ PostGIS)
- settlement_id, district_id

**ÐŸÐ¾Ð¸ÑÐº:**
- ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ autocomplete Ð¿Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ (prefix search)
- Fuzzy search Ñ Ð¾Ð¿ÐµÑ‡Ð°Ñ‚ÐºÐ°Ð¼Ð¸ Ñ‡ÐµÑ€ÐµÐ· `pg_trgm` (similarity)
- Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ð¾ ÑÐµÐºÑ‚Ð¾Ñ€Ð°Ð¼ Ñ‡ÐµÑ€ÐµÐ· `ST_Within`
- Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ð¾ bbox (Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ð²Ð°ÑŽÑ‰Ð¸Ð¹ Ð¿Ñ€ÑÐ¼Ð¾ÑƒÐ³Ð¾Ð»ÑŒÐ½Ð¸Ðº)
- Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ð¾ Ñ‚ÐµÐ³Ð°Ð¼

---

##### 9ï¸âƒ£ **categories** - ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ð·Ð°Ð²ÐµÐ´ÐµÐ½Ð¸Ð¹
| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| id | INTEGER | PRIMARY KEY |
| name | VARCHAR(100) | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ (ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ) |
| slug | VARCHAR(100) | URL-friendly Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ (ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ, Ð°Ð²Ñ‚Ð¾Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ) |

**Ð¡Ð²ÑÐ·Ð¸:**
- `1 â†’ Many` subcategories
- `1 â†’ Many` delivery_points

**ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹:** ÐŸÑ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹ Ð¿Ð¸Ñ‚Ð°Ð½Ð¸Ñ, ÐžÐ´ÐµÐ¶Ð´Ð° Ð¸ Ð¾Ð±ÑƒÐ²ÑŒ, Ð­Ð»ÐµÐºÑ‚Ñ€Ð¾Ð½Ð¸ÐºÐ° Ð¸ Ñ‚.Ð´.

---

##### ðŸ”Ÿ **subcategories** - ÐŸÐ¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸
| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| id | INTEGER | PRIMARY KEY |
| category_id | INTEGER | FK â†’ categories.id |
| name | VARCHAR(100) | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð´ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ |
| slug | VARCHAR(100) | URL-friendly Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ (Ð°Ð²Ñ‚Ð¾Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ) |

**Ð¡Ð²ÑÐ·Ð¸:**
- `Many â†’ 1` categories
- `1 â†’ Many` delivery_points

---

##### 1ï¸âƒ£1ï¸âƒ£ **tags** - Ð¢ÐµÐ³Ð¸ (Ñ€ÑƒÐ±Ñ€Ð¸ÐºÐ¸)
| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| id | INTEGER | PRIMARY KEY |
| name | VARCHAR(100) | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ Ñ‚ÐµÐ³Ð° (ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ) |
| slug | VARCHAR(100) | URL-friendly Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ (ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ, Ð°Ð²Ñ‚Ð¾Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ) |

**Ð¡Ð²ÑÐ·Ð¸:**
- `Many â†’ Many` delivery_points (Ñ‡ÐµÑ€ÐµÐ· delivery_point_tags)

**Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ:**
- Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð¿Ð¾ Ñ‚ÐµÐ³Ð°Ð¼
- ÐžÐ´Ð¸Ð½ Ñ‚ÐµÐ³ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ñƒ Ð¼Ð½Ð¾Ð³Ð¸Ñ… Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸
- ÐžÐ´Ð½Ð° Ñ‚Ð¾Ñ‡ÐºÐ° Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¸Ð¼ÐµÑ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ‚ÐµÐ³Ð¾Ð²

---

##### 1ï¸âƒ£2ï¸âƒ£ **delivery_point_tags** - Ð¡Ð²ÑÐ·ÑŒ Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð¸ Ñ‚ÐµÐ³Ð¾Ð²
| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| delivery_point_id | INTEGER | FK â†’ delivery_points.id, PRIMARY KEY |
| tag_id | INTEGER | FK â†’ tags.id, PRIMARY KEY |

**Ð¢Ð¸Ð¿ ÑÐ²ÑÐ·Ð¸:** Many-to-Many Ð¼ÐµÐ¶Ð´Ñƒ delivery_points Ð¸ tags

---

##### 1ï¸âƒ£3ï¸âƒ£ **product_categories** - ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² _(Ð¿Ð¾ÐºÐ° Ð½Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ)_
| ÐŸÐ¾Ð»Ðµ | Ð¢Ð¸Ð¿ | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ |
|------|-----|----------|
| id | INTEGER | PRIMARY KEY |
| name | VARCHAR(100) | ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ (ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ) |
| slug | VARCHAR(100) | URL-friendly Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ (ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ð¾Ðµ, Ð°Ð²Ñ‚Ð¾Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ) |
| description | TEXT | ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ |
| cost_multiplier | NUMERIC(5,2) | ÐœÐ½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ (Ð¿Ð¾ÐºÐ° Ð½Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ) |

**Ð¡Ñ‚Ð°Ñ‚ÑƒÑ:** Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° ÑÐ¾Ð·Ð´Ð°Ð½Ð° Ð´Ð»Ñ Ð±ÑƒÐ´ÑƒÑ‰ÐµÐ³Ð¾ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»Ð°, Ð¿Ð¾ÐºÐ° Ð½Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð² ÐºÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€Ðµ.

---

### ðŸ” ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð³ÐµÐ¾Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸

#### PostGIS Ñ‚Ð¸Ð¿Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…
- **POINT** - Ð´Ð»Ñ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚ (Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸, Ð Ð¦, Ð½Ð°ÑÐµÐ»ÐµÐ½Ð½Ñ‹Ðµ Ð¿ÑƒÐ½ÐºÑ‚Ñ‹)
- **POLYGON** - Ð´Ð»Ñ Ð³Ñ€Ð°Ð½Ð¸Ñ† (ÑÐµÐºÑ‚Ð¾Ñ€Ñ‹, Ñ€Ð°Ð¹Ð¾Ð½Ñ‹)
- **SRID 4326** - ÑÐ¸ÑÑ‚ÐµÐ¼Ð° ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚ WGS84 (ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚ Ð´Ð»Ñ GPS)

#### ÐŸÑ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð¸Ð½Ð´ÐµÐºÑÑ‹
Ð’ÑÐµ Ð³ÐµÐ¾Ð¼ÐµÑ‚Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¿Ð¾Ð»Ñ (`location`, `boundary`) Ð¸Ð¼ÐµÑŽÑ‚ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð¸Ð½Ð´ÐµÐºÑÑ‹ Ð´Ð»Ñ Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²:
```sql
ST_Within(point, polygon)  -- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð²Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð² Ð¿Ð¾Ð»Ð¸Ð³Ð¾Ð½
ST_Distance(point1, point2) -- Ð Ð°ÑÑ‡ÐµÑ‚ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ñ
```

#### ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð² ÐºÐ¾Ð´Ðµ
```python
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾Ð¿Ð°Ð´Ð°Ð½Ð¸Ñ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð² ÑÐµÐºÑ‚Ð¾Ñ€
query = select(DeliveryPoint, Sector).join(
    Sector,
    func.ST_Within(DeliveryPoint.location, Sector.boundary)
)
```

---

### âœ… Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ (MVP)

Ð ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð» Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡ÐµÐ½ Ð´Ð»Ñ MVP:

âœ… **ÐŸÐ¾Ð»Ð½Ð°Ñ Ð³ÐµÐ¾Ð³Ñ€Ð°Ñ„Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¸ÐµÑ€Ð°Ñ€Ñ…Ð¸Ñ** - Ð¾Ñ‚ ÑÑ‚Ñ€Ð°Ð½Ñ‹ Ð´Ð¾ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸  
âœ… **Ð¢Ð°Ñ€Ð¸Ñ„Ñ‹ Ð¸ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð°** - Ð³Ð¸Ð±ÐºÐ°Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° Ð´Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð°  
âœ… **Ð¡ÐµÐºÑ‚Ð¾Ñ€Ñ‹ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸** - Ð³Ñ€ÑƒÐ¿Ð¿Ð¸Ñ€Ð¾Ð²ÐºÐ° Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð°  
âœ… **Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ†ÐµÐ½Ñ‚Ñ€Ñ‹** - Ð´Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð¾Ñ‚ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ°  
âœ… **ÐœÐ¾Ñ‰Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸** - autocomplete, fuzzy search, Ð³ÐµÐ¾Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹  
âœ… **ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ‚Ð¾Ñ‡ÐµÐº** - categories, subcategories, tags  
âœ… **Ð“ÐµÐ¾Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹** - Ñ‡ÐµÑ€ÐµÐ· PostGIS  
âœ… **ÐœÐ¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸ Ð‘Ð”** - Ñ‡ÐµÑ€ÐµÐ· Alembic Ð´Ð»Ñ Ð²ÐµÑ€ÑÐ¸Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ ÑÑ…ÐµÐ¼Ñ‹  

---

### ðŸš€ ÐŸÐ»Ð°Ð½Ð¸Ñ€ÑƒÐµÐ¼Ñ‹Ðµ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ (Post-MVP)

#### 1ï¸âƒ£ **ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹ Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸**
- Ð’Ñ‹Ð½ÐµÑÑ‚Ð¸ Ð² Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½ÑƒÑŽ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ `delivery_point_contacts`
- ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ñ€Ð°Ð·Ð½Ñ‹Ñ… Ñ‚Ð¸Ð¿Ð¾Ð² ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð¾Ð² (phone, email, Ð¼ÐµÑÑÐµÐ½Ð´Ð¶ÐµÑ€Ñ‹)
- ÐžÑ‚Ð¼ÐµÑ‚ÐºÐ° Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ð°

#### 2ï¸âƒ£ **Ð Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹**
- Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ðµ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð² Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ðµ `delivery_point_schedules`
- Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ "Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ" Ð¸ Ð¿Ð¾Ð¸ÑÐº Ð¿Ð¾ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹
- ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ñ€Ð°Ð·Ð½Ð¾Ð³Ð¾ Ñ€Ð°ÑÐ¿Ð¸ÑÐ°Ð½Ð¸Ñ Ð¿Ð¾ Ð´Ð½ÑÐ¼ Ð½ÐµÐ´ÐµÐ»Ð¸

#### 3ï¸âƒ£ **ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²**
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ `cost_multiplier` Ð¸Ð· Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ `product_categories`
- Ð Ð°Ð·Ð½Ñ‹Ðµ Ñ‚Ð°Ñ€Ð¸Ñ„Ñ‹ Ð´Ð»Ñ Ñ…Ñ€ÑƒÐ¿ÐºÐ¸Ñ…/Ð³Ð°Ð±Ð°Ñ€Ð¸Ñ‚Ð½Ñ‹Ñ…/ÑÐºÐ¾Ñ€Ð¾Ð¿Ð¾Ñ€Ñ‚ÑÑ‰Ð¸Ñ…ÑÑ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð²
- Ð¡ÐµÐ·Ð¾Ð½Ð½Ñ‹Ðµ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚Ñ‹

#### 4ï¸âƒ£ **Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ Ñ‚Ð°Ñ€Ð¸Ñ„Ð¾Ð²**
- Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° `region_pricing_history` Ð´Ð»Ñ Ð°ÑƒÐ´Ð¸Ñ‚Ð° Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹
- Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð¾Ñ‚ÐºÐ°Ñ‚Ð° Ðº Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ð¼ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸ÑÐ¼

#### 5ï¸âƒ£ **ÐšÑÑˆÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð¾Ð²**
- Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° `calculation_cache` Ð´Ð»Ñ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð²
- Ð­ÐºÐ¾Ð½Ð¾Ð¼Ð¸Ñ Ð»Ð¸Ð¼Ð¸Ñ‚Ð¾Ð² Ð²Ð½ÐµÑˆÐ½Ð¸Ñ… API (OpenRouteService)
- Ð£ÑÐºÐ¾Ñ€ÐµÐ½Ð¸Ðµ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€ÑÑŽÑ‰Ð¸Ñ…ÑÑ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²

#### 6ï¸âƒ£ **ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ°**
- Ð›Ð¾Ð³Ð¸ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð¾Ð², ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ API
- ÐÐ½Ð°Ð»Ð¸Ð· Ð¿Ð¾Ð¿ÑƒÐ»ÑÑ€Ð½Ñ‹Ñ… Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¾Ð² Ð´Ð»Ñ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð°Ñ†Ð¸Ð¸

---

### ðŸ“Œ Ð—Ð°ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð¿Ð¾ Ð‘Ð”

**Ð¢ÐµÐºÑƒÑ‰Ð°Ñ ÑÑ…ÐµÐ¼Ð° Ð‘Ð” Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð° Ð´Ð»Ñ MVP:**
- âœ… Ð’ÑÐµ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸
- âœ… Ð­Ñ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð°Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ð° Ñ Ð³ÐµÐ¾Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸ Ñ‡ÐµÑ€ÐµÐ· PostGIS
- âœ… Ð“Ð¸Ð±ÐºÐ°Ñ ÑÐ¸ÑÑ‚ÐµÐ¼Ð° Ñ‚Ð°Ñ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸
- âœ… ÐœÐ¾Ñ‰Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº Ð¸ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸

**Ð—Ð°Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ñ Ð½Ðµ Ð±Ð»Ð¾ÐºÐ¸Ñ€ÑƒÑŽÑ‚ Ð·Ð°Ð¿ÑƒÑÐº:**
- ðŸ“Š Ð£Ð»ÑƒÑ‡ÑˆÐ°Ñ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒÑÐºÐ¸Ð¹ Ð¾Ð¿Ñ‹Ñ‚
- ðŸš€ Ð”Ð¾Ð±Ð°Ð²ÑÑ‚ Ð½Ð¾Ð²Ñ‹Ðµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ð¸
- ðŸ“ˆ ÐŸÐ¾Ð·Ð²Ð¾Ð»ÑÑ‚ ÑÐ¾Ð±Ð¸Ñ€Ð°Ñ‚ÑŒ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÑƒ
- ðŸ’° ÐžÐ¿Ñ‚Ð¸Ð¼Ð¸Ð·Ð¸Ñ€ÑƒÑŽÑ‚ Ñ€Ð°ÑÑ…Ð¾Ð´Ñ‹ Ð½Ð° Ð²Ð½ÐµÑˆÐ½Ð¸Ðµ API

---

## ðŸ”§ Ð¡ÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ… {#import-scripts}

Ð’ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸Ð¸ `scripts/` Ð½Ð°Ñ…Ð¾Ð´ÑÑ‚ÑÑ Ñ‚Ñ€Ð¸ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð° Ð´Ð»Ñ Ð¿ÐµÑ€Ð²Ð¾Ð½Ð°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð² Ð‘Ð”.

### 1ï¸âƒ£ **import_delivery_points.py** - Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚ Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð¸Ð· Excel

**ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ:** Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð¸Ð· Ñ„Ð°Ð¹Ð»Ð° `sochi_address.xlsx` Ð² Ð±Ð°Ð·Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ….

**Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»:**
- ÐŸÐ°Ñ€ÑÐ¸Ð½Ð³ Excel Ñ„Ð°Ð¹Ð»Ð° Ñ Ñ‚Ð¾Ñ‡ÐºÐ°Ð¼Ð¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸
- ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¸ÐµÑ€Ð°Ñ€Ñ…Ð¸Ð¸: Ð½Ð°ÑÐµÐ»ÐµÐ½Ð½Ñ‹Ðµ Ð¿ÑƒÐ½ÐºÑ‚Ñ‹ â†’ Ñ€Ð°Ð¹Ð¾Ð½Ñ‹ â†’ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸
- ÐÐ¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ð¹ Ð´Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ° (lowercase, Ð·Ð°Ð¼ÐµÐ½Ð° Ñ‘â†’Ðµ, ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÐ¿ÐµÑ†ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²)
- Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¸ Ð¿Ñ€Ð¸Ð²ÑÐ·ÐºÐ° Ñ‚ÐµÐ³Ð¾Ð² (Ñ€ÑƒÐ±Ñ€Ð¸Ðº)
- Ð‘Ð°Ñ‚Ñ‡Ð¸Ð½Ð³ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹ (Ð¿Ð¾ 100 Ð·Ð°Ð¿Ð¸ÑÐµÐ¹) Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸
- Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚ Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ…
- ÐŸÐ¾Ð´Ñ€Ð¾Ð±Ð½Ð°Ñ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð° Ñ progress bar

**Ð—Ð°Ð¿ÑƒÑÐº:**
```bash
poetry run python scripts/import_delivery_points.py
poetry run python scripts/import_delivery_points.py --debug  # Ð ÐµÐ¶Ð¸Ð¼ Ð¾Ñ‚Ð»Ð°Ð´ÐºÐ¸
```

**Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:** ~5000 Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð´Ð»Ñ ÐšÑ€Ð°ÑÐ½Ð¾Ð´Ð°Ñ€ÑÐºÐ¾Ð³Ð¾ ÐºÑ€Ð°Ñ (Ð³. Ð¡Ð¾Ñ‡Ð¸ Ð¸ Ð¾ÐºÑ€ÐµÑÑ‚Ð½Ð¾ÑÑ‚Ð¸)

---

### 2ï¸âƒ£ **import_sectors.py** - Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð¸Ð· GeoJSON

**ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ:** Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¿Ð¾Ð»Ð¸Ð³Ð¾Ð½Ð¾Ð² ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð¸Ð· Ñ„Ð°Ð¹Ð»Ð° `ÑÐµÐºÑ‚Ð¾Ñ€Ð°.json`.

**Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»:**
- Ð§Ñ‚ÐµÐ½Ð¸Ðµ GeoJSON FeatureCollection
- ÐŸÑ€ÐµÐ¾Ð±Ñ€Ð°Ð·Ð¾Ð²Ð°Ð½Ð¸Ðµ Shapely Ð³ÐµÐ¾Ð¼ÐµÑ‚Ñ€Ð¸Ð¸ Ð² PostGIS POLYGON
- ÐŸÑ€Ð¸Ð²ÑÐ·ÐºÐ° ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ðº Ñ€ÐµÐ³Ð¸Ð¾Ð½Ñƒ (ÐšÑ€Ð°ÑÐ½Ð¾Ð´Ð°Ñ€ÑÐºÐ¸Ð¹ ÐºÑ€Ð°Ð¹)
- Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð³ÐµÐ¾Ð¼ÐµÑ‚Ñ€Ð¸Ð¸ Ð¿Ð¾Ð»Ð¸Ð³Ð¾Ð½Ð¾Ð²
- Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ñ… Ð¸Ð½Ð´ÐµÐºÑÐ¾Ð²

**Ð—Ð°Ð¿ÑƒÑÐº:**
```bash
poetry run python scripts/import_sectors.py
```

**Ð˜ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº Ð´Ð°Ð½Ð½Ñ‹Ñ…:** ÐŸÐ¾Ð»Ð¸Ð³Ð¾Ð½Ñ‹ ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ Ñ‡ÐµÑ€ÐµÐ· [geojson.io](https://geojson.io/), ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ñ‹ Ð² [`ÑÐµÐºÑ‚Ð¾Ñ€Ð°.json`](./ÑÐµÐºÑ‚Ð¾Ñ€Ð°.json)

**Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:** ~45 ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð´Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸

---

### 3ï¸âƒ£ **seed_distribution_centers.py** - Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ñ†ÐµÐ½Ñ‚Ñ€Ð¾Ð²

**ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ:** Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð Ð¦ (Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ñ†ÐµÐ½Ñ‚Ñ€Ð¾Ð²) Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸ÐµÐ¼ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚ Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÐ°Ð¼.

**Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¾Ð½Ð°Ð»:**
- Ð“ÐµÐ¾ÐºÐ¾Ð´Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð°Ð´Ñ€ÐµÑÐ¾Ð² Ñ‡ÐµÑ€ÐµÐ· **Yandex Geocoder API**
- ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ñ‡Ð½Ñ‹Ñ… ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚ Ð Ð¦
- ÐŸÑ€Ð¸Ð²ÑÐ·ÐºÐ° Ðº Ñ€ÐµÐ³Ð¸Ð¾Ð½Ñƒ
- ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ð¾Ð² Ð¿ÐµÑ€ÐµÐ´ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸ÐµÐ¼
- Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐ° ÑÑƒÑ‰ÐµÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… Ð·Ð°Ð¿Ð¸ÑÐµÐ¹

**Ð¢Ñ€ÐµÐ±Ð¾Ð²Ð°Ð½Ð¸Ñ:**
- API ÐºÐ»ÑŽÑ‡ Ð¯Ð½Ð´ÐµÐºÑÐ° Ð² `.env`: `YANDEX_API_KEY`
- Ð‘ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ñ‹Ð¹ Ñ‚Ð°Ñ€Ð¸Ñ„: Ð´Ð¾ 1000 Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð²/Ð´ÐµÐ½ÑŒ

**Ð—Ð°Ð¿ÑƒÑÐº:**
```bash
poetry run python scripts/seed_distribution_centers.py
```

**Ð”Ð°Ð½Ð½Ñ‹Ðµ:** 8 Ð Ð¦ Ð´Ð»Ñ ÐšÑ€Ð°ÑÐ½Ð¾Ð´Ð°Ñ€ÑÐºÐ¾Ð³Ð¾ ÐºÑ€Ð°Ñ (ÐÐ´Ð»ÐµÑ€ÑÐºÐ¸Ð¹, Ð¥Ð¾ÑÑ‚Ð¸Ð½ÑÐºÐ¸Ð¹, Ð¦ÐµÐ½Ñ‚Ñ€Ð°Ð»ÑŒÐ½Ñ‹Ð¹, Ð›Ð°Ð·Ð°Ñ€ÐµÐ²ÑÐºÐ¸Ð¹ Ñ€Ð°Ð¹Ð¾Ð½Ñ‹)

---

### ðŸ“ ÐŸÐ¾Ñ€ÑÐ´Ð¾Ðº Ð·Ð°Ð¿ÑƒÑÐºÐ° ÑÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²

```bash
# 1. ÐŸÑ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð¼Ð¸Ð³Ñ€Ð°Ñ†Ð¸Ð¸
poetry run alembic upgrade head

# 2. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ†ÐµÐ½Ñ‚Ñ€Ñ‹
poetry run python scripts/seed_distribution_centers.py

# 3. Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐµÐºÑ‚Ð¾Ñ€Ñ‹
poetry run python scripts/import_sectors.py

# 4. Ð˜Ð¼Ð¿Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸
poetry run python scripts/import_delivery_points.py
```

**ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ:** Ð¡ÐºÑ€Ð¸Ð¿Ñ‚Ñ‹ Ð¸Ð´ÐµÐ¼Ð¿Ð¾Ñ‚ÐµÐ½Ñ‚Ð½Ñ‹ - Ð¼Ð¾Ð¶Ð½Ð¾ Ð·Ð°Ð¿ÑƒÑÐºÐ°Ñ‚ÑŒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ€Ð°Ð·, Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ñ‹ Ð½Ðµ ÑÐ¾Ð·Ð´Ð°Ð´ÑƒÑ‚ÑÑ.

---

## ðŸŒ API Endpoints {#api-endpoints}

API Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð¾ Ð¿Ð¾ Ð°Ð´Ñ€ÐµÑÑƒ `/api/v1/` Ð¸ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ñ‡ÐµÑ€ÐµÐ· **OpenAPI (Swagger)**.

**Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ:** 
- Swagger UI: `/docs`
- ReDoc: `/redoc`
- ðŸ“š Ð­Ñ‚Ð° Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð² HTML: `/docs/overview` (Ð¾Ñ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ÑÑ ÐºÐ°Ðº ÐºÑ€Ð°ÑÐ¸Ð²Ð°Ñ ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ)

### ðŸ“ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° API

```
/api/v1/
  â”œâ”€â”€ /countries          # Ð¡Ñ‚Ñ€Ð°Ð½Ñ‹
  â”œâ”€â”€ /regions            # Ð ÐµÐ³Ð¸Ð¾Ð½Ñ‹
  â”œâ”€â”€ /sectors            # Ð¡ÐµÐºÑ‚Ð¾Ñ€Ñ‹ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸
  â”œâ”€â”€ /delivery-points    # Ð¢Ð¾Ñ‡ÐºÐ¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸
  â”œâ”€â”€ /tags               # Ð¢ÐµÐ³Ð¸ (Ñ€ÑƒÐ±Ñ€Ð¸ÐºÐ¸)
  â””â”€â”€ /calculator         # ÐšÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸
```

---

### 1ï¸âƒ£ Countries - Ð¡Ñ‚Ñ€Ð°Ð½Ñ‹

#### `GET /api/v1/countries`
ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑÐ¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… ÑÑ‚Ñ€Ð°Ð½.

**Response:** `200 OK`
```json
[
  {
    "id": 1,
    "name": "Ð Ð¾ÑÑÐ¸Ñ",
    "code": "RU"
  }
]
```

#### `GET /api/v1/countries/{country_id}`
ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑÑ‚Ñ€Ð°Ð½Ñƒ Ð¿Ð¾ ID.

**Response:** `200 OK` Ð¸Ð»Ð¸ `404 Not Found`

---

### 2ï¸âƒ£ Regions - Ð ÐµÐ³Ð¸Ð¾Ð½Ñ‹

#### `GET /api/v1/regions`
ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ ÑÐ¿Ð¸ÑÐ¾Ðº Ð²ÑÐµÑ… Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð¾Ð².

**Query Parameters:**
- `country_id` (optional) - Ñ„Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ ÑÑ‚Ñ€Ð°Ð½Ðµ

**Response:** `200 OK`
```json
[
  {
    "id": 1,
    "name": "ÐšÑ€Ð°ÑÐ½Ð¾Ð´Ð°Ñ€ÑÐºÐ¸Ð¹ ÐºÑ€Ð°Ð¹",
    "type": "ÐºÑ€Ð°Ð¹",
    "country": {
      "id": 1,
      "name": "Ð Ð¾ÑÑÐ¸Ñ",
      "code": "RU"
    }
  }
]
```

#### `GET /api/v1/regions/{region_id}`
ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð´ÐµÑ‚Ð°Ð»ÑŒÐ½ÑƒÑŽ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸ÑŽ Ð¾ Ñ€ÐµÐ³Ð¸Ð¾Ð½Ðµ.

**Response:** ÐŸÐ¾Ð»Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð²ÐºÐ»ÑŽÑ‡Ð°Ñ Ð Ð¦, Ñ‚Ð°Ñ€Ð¸Ñ„Ñ‹ Ð¸ ÑÑ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÑƒ

#### `GET /api/v1/regions/{region_id}/pricing`
ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ñ‚Ð°Ñ€Ð¸Ñ„Ñ‹ Ð¸ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° Ð´Ð»Ñ Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð°.

**Response:** Ð’ÑÐµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð¸Ð· Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ `region_pricing`

#### `PATCH /api/v1/regions/{region_id}/pricing`
ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ñ‚Ð°Ñ€Ð¸Ñ„Ñ‹ (Ñ‡Ð°ÑÑ‚Ð¸Ñ‡Ð½Ð¾Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ).

**Body Example:**
```json
{
  "fuel_price_per_liter": "75.00",
  "driver_hourly_rate": "600.00"
}
```

---

### 3ï¸âƒ£ Sectors - Ð¡ÐµÐºÑ‚Ð¾Ñ€Ñ‹ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸

#### `GET /api/v1/sectors?region_id={id}`
ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð²ÑÐµ ÑÐµÐºÑ‚Ð¾Ñ€Ñ‹ Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð° Ñ Ð³Ñ€Ð°Ð½Ð¸Ñ†Ð°Ð¼Ð¸ Ð² GeoJSON Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ.

**Query Parameters:**
- `region_id` (required) - ID Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð°

**Response:** `200 OK`
```json
[
  {
    "id": 1,
    "region_id": 1,
    "name": "ÐÐ´Ð»ÐµÑ€ÑÐºÐ¸Ð¹ ÑÐµÐºÑ‚Ð¾Ñ€ 1",
    "description": "Ð¡ÐµÐºÑ‚Ð¾Ñ€ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð² ÐÐ´Ð»ÐµÑ€ÑÐºÐ¾Ð¼ Ñ€Ð°Ð¹Ð¾Ð½Ðµ",
    "boundary": {
      "type": "Polygon",
      "coordinates": [[[39.723, 43.585], [39.730, 43.585], ...]]
    }
  }
]
```

---

### 4ï¸âƒ£ Delivery Points - Ð¢Ð¾Ñ‡ÐºÐ¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸

#### `POST /api/v1/delivery-points/search`
ÐœÐ¾Ñ‰Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ð¼Ð¸.

**Body:**
```json
{
  "region_id": 1,
  "only_in_sectors": false,
  "search": "Ð¼Ð°Ð³Ð°Ð·Ð¸Ð½",
  "bbox": {
    "min_lng": 39.7,
    "min_lat": 43.5,
    "max_lng": 39.8,
    "max_lat": 43.6
  },
  "tag_ids": [1, 2],
  "limit": 10
}
```

**Ð’Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸ Ð¿Ð¾Ð¸ÑÐºÐ°:**
- âœ… **Autocomplete** Ð¿Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ (min 3 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°)
- âœ… **Fuzzy search** Ñ Ð¾Ð¿ÐµÑ‡Ð°Ñ‚ÐºÐ°Ð¼Ð¸ (Ð¾Ñ‚ 5 ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð², Ñ‡ÐµÑ€ÐµÐ· pg_trgm)
- âœ… **Ð“ÐµÐ¾Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ñ‹**: bbox, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð² ÑÐµÐºÑ‚Ð¾Ñ€Ð°Ñ…
- âœ… **Ð¤Ð¸Ð»ÑŒÑ‚Ñ€ Ð¿Ð¾ Ñ‚ÐµÐ³Ð°Ð¼** (OR Ð»Ð¾Ð³Ð¸ÐºÐ°)
- âœ… ÐÐ¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ‚ÐµÐºÑÑ‚Ð° (lowercase, Ñ‘â†’Ðµ, ÑƒÐ´Ð°Ð»ÐµÐ½Ð¸Ðµ ÑÐ¿ÐµÑ†ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð²)

**Response:** ÐœÐ°ÑÑÐ¸Ð² Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ñ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚Ð°Ð¼Ð¸ Ð² GeoJSON

---

### 5ï¸âƒ£ Tags - Ð¢ÐµÐ³Ð¸ (Ñ€ÑƒÐ±Ñ€Ð¸ÐºÐ¸)

#### `GET /api/v1/tags`
ÐŸÐ¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð²ÑÐµ Ñ‚ÐµÐ³Ð¸ Ð´Ð»Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸.

**Response:**
```json
[
  {
    "id": 1,
    "name": "ÐŸÑ€Ð¾Ð´ÑƒÐºÑ‚Ñ‹ Ð¿Ð¸Ñ‚Ð°Ð½Ð¸Ñ",
    "slug": "produkty-pitaniya"
  }
]
```

---

### 6ï¸âƒ£ Calculator - ÐšÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ ðŸ§®

Ð”Ð²Ð° Ñ€ÐµÐ¶Ð¸Ð¼Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹: Ñ€Ð°ÑÑ‡ÐµÑ‚ Ð¿Ð¾ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ð¼ Ñ‚Ð¾Ñ‡ÐºÐ°Ð¼ Ð¸Ð»Ð¸ Ð¿Ð¾ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð½Ð¾Ð¼Ñƒ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ñƒ.

---

#### `POST /api/v1/calculator/by-points`
**Ð Ð°ÑÑ‡ÐµÑ‚ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¿Ð¾ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ð¼ Ñ‚Ð¾Ñ‡ÐºÐ°Ð¼ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸**

ÐšÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÑ‚ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ñ‚Ð¾Ñ‡ÐµÐº Ð¸ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ð¸Ð· Ð¿ÐµÑ€ÐµÐ´Ð°Ð½Ð½Ñ‹Ñ… ID.

**Request Body:**
```json
{
  "region_id": 1,
  "supplier_location": {
    "latitude": 43.585472,
    "longitude": 39.723098
  },
  "product": {
    "length_cm": 20,
    "width_cm": 10,
    "height_cm": 10,
    "weight_kg": 1.0,
    "items_per_box": 15
  },
  "delivery_point_ids": [1, 2, 3, ...]
}
```

**Response:**
```json
{
  "items_in_standard_box": 18,
  "cost_per_item": 38.29,
  "cost_per_supplier_box": 574.35,
  "delivery_points_used": 150,
  "delivery_points_ignored": 5,
  "sectors_count": 3,
  "distance_to_dc_km": 15.50,
  "nearest_dc_name": "Ð Ð¦ Ð¡Ð¾Ñ‡Ð¸"
}
```

**Ð˜Ð³Ð½Ð¾Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ñ‚Ð¾Ñ‡ÐµÐº:**
- Ð¢Ð¾Ñ‡ÐºÐ¸ Ð²Ð½Ðµ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð° (Ð½Ðµ Ð¿Ð¾Ð¿Ð°Ð´Ð°ÑŽÑ‚ Ð² Ð¿Ð¾Ð»Ð¸Ð³Ð¾Ð½Ñ‹)
- ÐÐµÐ°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸ (`is_active = false`)

---

#### `POST /api/v1/calculator/estimate`
**Ð Ð°ÑÑ‡ÐµÑ‚ Ð¿Ñ€Ð¸Ð±Ð»Ð¸Ð·Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¿Ð¾ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ñƒ Ñ‚Ð¾Ñ‡ÐµÐº**

Ð”Ð»Ñ Ð¿Ñ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾Ð¹ Ð¾Ñ†ÐµÐ½ÐºÐ¸, ÐºÐ¾Ð³Ð´Ð° ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸ ÐµÑ‰Ðµ Ð½Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ñ‹.

**Request Body:**
```json
{
  "region_id": 1,
  "supplier_location": {
    "latitude": 43.585472,
    "longitude": 39.723098
  },
  "product": {
    "length_cm": 20,
    "width_cm": 10,
    "height_cm": 10,
    "weight_kg": 1.0,
    "items_per_box": 15
  },
  "delivery": {
    "num_points": 300,
    "num_sectors": 10
  }
}
```

**ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€ `num_sectors`:**
- Ð•ÑÐ»Ð¸ Ð½Ðµ ÑƒÐºÐ°Ð·Ð°Ð½ â†’ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð°
- Ð•ÑÐ»Ð¸ ÑƒÐºÐ°Ð·Ð°Ð½ â†’ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð°

**Response:**
```json
{
  "items_in_standard_box": 18,
  "cost_per_item": 38.29,
  "cost_per_supplier_box": 574.35,
  "distance_to_dc_km": 15.50,
  "nearest_dc_name": "Ð Ð¦ Ð¡Ð¾Ñ‡Ð¸"
}
```

---

### ðŸ“ Ð‘Ð¸Ð·Ð½ÐµÑ-Ð»Ð¾Ð³Ð¸ÐºÐ° ÐºÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€Ð°

#### Ð­Ñ‚Ð°Ð¿ 1: ÐŸÐ¾Ð¸ÑÐº Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐµÐ³Ð¾ Ð Ð¦

1. **Ð’Ñ‹Ð±Ð¾Ñ€ ÐºÐ°Ð½Ð´Ð¸Ð´Ð°Ñ‚Ð¾Ð²:**
   - Ð‘ÐµÑ€ÑƒÑ‚ÑÑ Ð²ÑÐµ Ð°ÐºÑ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð Ð¦ (`is_active = true`)
   - Ð Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¿Ñ€ÑÐ¼Ð¾Ðµ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ (Ð¿Ð¾ Ð¿Ñ€ÑÐ¼Ð¾Ð¹) Ð¾Ñ‚ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ° Ð´Ð¾ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð Ð¦ Ñ‡ÐµÑ€ÐµÐ· Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ñƒ **Haversine**

2. **Ð’Ñ‹Ð±Ð¾Ñ€ Ñ‚Ð¾Ð¿-3 Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ñ…:**
   - Ð Ð¦ ÑÐ¾Ñ€Ñ‚Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð¿Ð¾ Ð¿Ñ€ÑÐ¼Ð¾Ð¼Ñƒ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸ÑŽ
   - Ð‘ÐµÑ€ÑƒÑ‚ÑÑ 3 Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ñ… ÐºÐ°Ð½Ð´Ð¸Ð´Ð°Ñ‚Ð°

3. **Ð Ð°ÑÑ‡ÐµÑ‚ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð°:**
   - Ð”Ð»Ñ Ñ‚Ð¾Ð¿-3 Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ÑÑ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ðµ Ð´Ð¾Ñ€Ð¾Ð¶Ð½Ð¾Ðµ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· **OpenRouteService API**
   - Ð•ÑÐ»Ð¸ API Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ â†’ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚: `Ð¿Ñ€ÑÐ¼Ð¾Ðµ_Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ã— 1.4`
   - Ð’Ñ‹Ð±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ Ð Ð¦ Ñ Ð¼Ð¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¼ Ð´Ð¾Ñ€Ð¾Ð¶Ð½Ñ‹Ð¼ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸ÐµÐ¼

**Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:** Ð Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð´Ð¾ Ð Ð¦ (`distance_to_dc_km`) Ð´Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸

---

#### Ð­Ñ‚Ð°Ð¿ 2: ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ñ‡ÐµÐº Ð¸ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð²

**Ð”Ð»Ñ `/by-points`:**
- Ð§ÐµÑ€ÐµÐ· PostGIS Ð·Ð°Ð¿Ñ€Ð¾Ñ `ST_Within` Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ÑÑ Ð¿Ð¾Ð¿Ð°Ð´Ð°Ð½Ð¸Ðµ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð² Ð»ÑŽÐ±Ð¾Ð¹ ÑÐµÐºÑ‚Ð¾Ñ€ Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð°
- ÐŸÐ¾Ð´ÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ñ‚Ð¾Ñ‡ÐµÐº Ð¸ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð²
- Ð¢Ð¾Ñ‡ÐºÐ¸ Ð²Ð½Ðµ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ð¸Ð³Ð½Ð¾Ñ€Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ

**Ð”Ð»Ñ `/estimate`:**
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑŽÑ‚ÑÑ Ð¿ÐµÑ€ÐµÐ´Ð°Ð½Ð½Ñ‹Ðµ `num_points` Ð¸ `num_sectors`
- Ð•ÑÐ»Ð¸ `num_sectors` Ð½Ðµ ÑƒÐºÐ°Ð·Ð°Ð½ â†’ Ð±ÐµÑ€ÐµÑ‚ÑÑ `COUNT(*)` Ð¸Ð· Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ `sectors`

---

#### Ð­Ñ‚Ð°Ð¿ 3: Ð Ð°ÑÑ‡ÐµÑ‚ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ñ€ÐµÐ¹ÑÐ°

Ð’ÑÐµ Ñ€Ð°ÑÑ‡ÐµÑ‚Ñ‹ Ð¾ÑÐ½Ð¾Ð²Ð°Ð½Ñ‹ Ð½Ð° Ñ‚Ð°Ñ€Ð¸Ñ„Ð°Ñ… Ð¸Ð· Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ `region_pricing`.

##### 3.1 Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»Ñ
```
driver_cost = planned_work_hours Ã— driver_hourly_rate
```

##### 3.2 Ð’Ñ‹Ñ€ÑƒÑ‡ÐºÐ° ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸
```
company_revenue = service_fee_per_kg Ã— standard_trip_weight
```

##### 3.3 Ð Ð°ÑÑ…Ð¾Ð´ Ñ‚Ð¾Ð¿Ð»Ð¸Ð²Ð°
```
fuel_liters = (fuel_consumption_per_100km / 100) Ã— (distance_to_dc_km Ã— 2)
fuel_cost = fuel_liters Ã— fuel_price_per_liter
```
_Ã— 2 Ð¿Ð¾Ñ‚Ð¾Ð¼Ñƒ Ñ‡Ñ‚Ð¾ Ñ‚ÑƒÐ´Ð° Ð¸ Ð¾Ð±Ñ€Ð°Ñ‚Ð½Ð¾_

##### 3.4 ÐÐ¼Ð¾Ñ€Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ Ñ‚Ñ€Ð°Ð½ÑÐ¿Ð¾Ñ€Ñ‚Ð°
```
transport_cost = fuel_cost Ã— depreciation_coefficient
```

##### 3.5 Ð¡ÐºÐ»Ð°Ð´ÑÐºÐ°Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð½Ð° Ð Ð¦
```
warehouse_cost = warehouse_processing_per_kg Ã— standard_trip_weight
```

##### 3.6 Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ (Ñ ÑƒÑ‡ÐµÑ‚Ð¾Ð¼ ÑÐºÐ¸Ð´Ð¾Ðº)

**Ð•ÑÐ»Ð¸ Ñ‚Ð¾Ñ‡ÐµÐº Ð¼ÐµÐ½ÑŒÑˆÐµ Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼Ð°:**
```
delivery_cost = num_sectors Ã— delivery_point_cost Ã— min_points_for_discount
```

**Ð•ÑÐ»Ð¸ Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð´Ð»Ñ ÑÐºÐ¸Ð´ÐºÐ¸:**
```
discount_steps = (num_points - min_points_for_discount) / discount_step_points
discount_percent = initial_discount_percent + (discount_steps Ã— discount_step_percent)

base_cost = num_sectors Ã— delivery_point_cost Ã— min_points_for_discount
delivery_cost = base_cost Ã— (1 - discount_percent / 100)
```

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ ÑÐºÐ¸Ð´Ð¾Ðº:**
- ÐœÐ¸Ð½Ð¸Ð¼ÑƒÐ¼ Ð´Ð»Ñ ÑÐºÐ¸Ð´ÐºÐ¸: 100 Ñ‚Ð¾Ñ‡ÐµÐº
- Ð¨Ð°Ð³ Ð¿Ñ€Ð¸Ñ€Ð¾ÑÑ‚Ð°: 50 Ñ‚Ð¾Ñ‡ÐµÐº
- Ð¡Ñ‚Ð°Ñ€Ñ‚Ð¾Ð²Ð°Ñ ÑÐºÐ¸Ð´ÐºÐ°: 5%
- Ð¨Ð°Ð³ ÑÐºÐ¸Ð´ÐºÐ¸: 5%

| Ð¢Ð¾Ñ‡ÐµÐº | Ð¡ÐºÐ¸Ð´ÐºÐ° |
|-------|--------|
| < 100 | 0% |
| 100-149 | 5% |
| 150-199 | 10% |
| 200-249 | 15% |
| 250+ | 20% |

##### 3.7 Ð˜Ñ‚Ð¾Ð³Ð¾Ð²Ð°Ñ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ñ€ÐµÐ¹ÑÐ°
```
total_trip_cost = driver_cost + company_revenue + transport_cost + 
                  warehouse_cost + delivery_cost
```

##### 3.8 Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ ÑÑ‚Ð°Ð»Ð¾Ð½Ð½Ð¾Ð¹ ÐºÐ¾Ñ€Ð¾Ð±ÐºÐ¸
```
num_standard_boxes = standard_trip_weight / standard_box_max_weight
standard_box_cost = total_trip_cost / num_standard_boxes
```

---

#### Ð­Ñ‚Ð°Ð¿ 4: Ð Ð°ÑÑ‡ÐµÑ‚ Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ñ‚Ð¾Ð²Ð°Ñ€Ð°

ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ ÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ‚Ð¾Ð²Ð°Ñ€Ð¾Ð² Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ° Ð¿Ð¾Ð¼ÐµÑ‰Ð°ÐµÑ‚ÑÑ Ð² ÑÑ‚Ð°Ð»Ð¾Ð½Ð½ÑƒÑŽ ÐºÐ¾Ñ€Ð¾Ð±ÐºÑƒ.

##### 4.1 ÐŸÐ¾ Ð³Ð°Ð±Ð°Ñ€Ð¸Ñ‚Ð°Ð¼
```
n_length = standard_box_length Ã· product.length_cm
n_width = standard_box_width Ã· product.width_cm  
n_height = standard_box_height Ã· product.height_cm

items_by_dimensions = n_length Ã— n_width Ã— n_height
```
_Ð¦ÐµÐ»Ð¾Ñ‡Ð¸ÑÐ»ÐµÐ½Ð½Ð¾Ðµ Ð´ÐµÐ»ÐµÐ½Ð¸Ðµ_

##### 4.2 ÐŸÐ¾ Ð²ÐµÑÑƒ
```
items_by_weight = standard_box_max_weight Ã· product.weight_kg
```

##### 4.3 Ð˜Ñ‚Ð¾Ð³Ð¾Ð²Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾
```
items_in_standard_box = MIN(items_by_dimensions, items_by_weight)
```
_Ð‘ÐµÑ€ÐµÑ‚ÑÑ Ð¼Ð¸Ð½Ð¸Ð¼ÑƒÐ¼ Ð¸Ð· Ð´Ð²ÑƒÑ… Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ð¹_

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**
- Ð­Ñ‚Ð°Ð»Ð¾Ð½Ð½Ð°Ñ ÐºÐ¾Ñ€Ð¾Ð±ÐºÐ°: 60Ã—40Ã—40 ÑÐ¼, Ð¼Ð°ÐºÑ. 30 ÐºÐ³
- Ð¢Ð¾Ð²Ð°Ñ€ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ°: 20Ã—10Ã—10 ÑÐ¼, 1 ÐºÐ³
- ÐŸÐ¾ Ñ€Ð°Ð·Ð¼ÐµÑ€Ð°Ð¼: (60Ã·20) Ã— (40Ã·10) Ã— (40Ã·10) = 3 Ã— 4 Ã— 4 = **48 ÑˆÑ‚**
- ÐŸÐ¾ Ð²ÐµÑÑƒ: 30 Ã· 1 = **30 ÑˆÑ‚**
- **Ð˜Ñ‚Ð¾Ð³Ð¾: 30 ÑˆÑ‚** (Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð¿Ð¾ Ð²ÐµÑÑƒ)

---

#### Ð­Ñ‚Ð°Ð¿ 5: Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ð°Ñ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ

##### 5.1 Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð·Ð° ÐµÐ´Ð¸Ð½Ð¸Ñ†Ñƒ Ñ‚Ð¾Ð²Ð°Ñ€Ð°
```
cost_per_item = standard_box_cost / items_in_standard_box
```

##### 5.2 Ð¡Ñ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð·Ð° ÐºÐ¾Ñ€Ð¾Ð±ÐºÑƒ Ð¿Ð¾ÑÑ‚Ð°Ð²Ñ‰Ð¸ÐºÐ°
```
cost_per_supplier_box = cost_per_item Ã— items_per_box
```

Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð¾ÐºÑ€ÑƒÐ³Ð»ÑÑŽÑ‚ÑÑ Ð´Ð¾ 2 Ð·Ð½Ð°ÐºÐ¾Ð² Ð¿Ð¾ÑÐ»Ðµ Ð·Ð°Ð¿ÑÑ‚Ð¾Ð¹.

---

### ðŸ”‘ ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ ÐºÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€Ð°

âœ… **Ð£Ñ‡ÐµÑ‚ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð´Ð¾Ñ€Ð¾Ð³** - Ñ‡ÐµÑ€ÐµÐ· OpenRouteService API Ð¸Ð»Ð¸ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚  
âœ… **Ð“ÐµÐ¾Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹** - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ñ‚Ð¾Ñ‡ÐµÐº Ð² ÑÐµÐºÑ‚Ð¾Ñ€Ð°Ñ… Ñ‡ÐµÑ€ÐµÐ· PostGIS  
âœ… **Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° ÑÐºÐ¸Ð´Ð¾Ðº** - Ð¿Ñ€Ð¾Ð³Ñ€ÐµÑÑÐ¸Ð²Ð½Ð°Ñ ÑˆÐºÐ°Ð»Ð° Ð¾Ñ‚ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð° Ñ‚Ð¾Ñ‡ÐµÐº  
âœ… **Ð”Ð²Ð¾Ð¹Ð½Ð¾Ðµ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ** - Ð¿Ð¾ Ð²ÐµÑÑƒ Ð˜ Ð¿Ð¾ Ð³Ð°Ð±Ð°Ñ€Ð¸Ñ‚Ð°Ð¼  
âœ… **Ð’Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…** - Ñ‡ÐµÑ€ÐµÐ· Pydantic schemas  
âœ… **ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ð¾ÑˆÐ¸Ð±Ð¾Ðº** - Ð¿Ð¾Ð½ÑÑ‚Ð½Ñ‹Ðµ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ð± Ð¾ÑˆÐ¸Ð±ÐºÐ°Ñ…  

---

## ðŸ—º Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ Ð³ÐµÐ¾Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸ {#geodata}

ÐŸÑ€Ð¾ÐµÐºÑ‚ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ Ð³ÐµÐ¾Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ PostGIS Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚Ð°Ð¼Ð¸, Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸ÑÐ¼Ð¸ Ð¸ Ð¿Ð¾Ð»Ð¸Ð³Ð¾Ð½Ð°Ð¼Ð¸.

### ðŸ“ Ð¢Ð¸Ð¿Ñ‹ Ð³ÐµÐ¾Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ

#### 1. **POINT** - Ð¢Ð¾Ñ‡ÐºÐ¸ (ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚Ñ‹)
Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð¼ÐµÑÑ‚Ð¾Ð¿Ð¾Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ:
- Ð¢Ð¾Ñ‡ÐºÐ¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ (`delivery_points.location`)
- Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ñ†ÐµÐ½Ñ‚Ñ€Ñ‹ (`distribution_centers.location`)
- Ð¦ÐµÐ½Ñ‚Ñ€Ñ‹ Ð½Ð°ÑÐµÐ»ÐµÐ½Ð½Ñ‹Ñ… Ð¿ÑƒÐ½ÐºÑ‚Ð¾Ð² (`settlements.location`)

**Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚:** Longitude (Ð´Ð¾Ð»Ð³Ð¾Ñ‚Ð°), Latitude (ÑˆÐ¸Ñ€Ð¾Ñ‚Ð°)

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð² SQL:**
```sql
-- Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸
ST_SetSRID(ST_MakePoint(39.723098, 43.585472), 4326)
```

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð² Python (Shapely):**
```python
from shapely.geometry import Point
point = Point(39.723098, 43.585472)  # lon, lat
```

**GeoJSON Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚:**
```json
{
  "type": "Point",
  "coordinates": [39.723098, 43.585472]
}
```

---

#### 2. **POLYGON** - ÐŸÐ¾Ð»Ð¸Ð³Ð¾Ð½Ñ‹ (Ð¾Ð±Ð»Ð°ÑÑ‚Ð¸)
Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ñ Ð³Ñ€Ð°Ð½Ð¸Ñ†:
- Ð¡ÐµÐºÑ‚Ð¾Ñ€Ñ‹ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ (`sectors.boundary`)
- Ð Ð°Ð¹Ð¾Ð½Ñ‹ Ð½Ð°ÑÐµÐ»ÐµÐ½Ð½Ñ‹Ñ… Ð¿ÑƒÐ½ÐºÑ‚Ð¾Ð² (`districts.boundary`)

**ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð² SQL:**
```sql
-- Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð»Ð¸Ð³Ð¾Ð½Ð°
ST_SetSRID(
  ST_GeomFromGeoJSON('{"type":"Polygon","coordinates":[[[39.7,43.5],[39.8,43.5],[39.8,43.6],[39.7,43.6],[39.7,43.5]]]}'),
  4326
)
```

**GeoJSON Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚:**
```json
{
  "type": "Polygon",
  "coordinates": [
    [
      [39.7, 43.5],
      [39.8, 43.5],
      [39.8, 43.6],
      [39.7, 43.6],
      [39.7, 43.5]
    ]
  ]
}
```

---

### ðŸŒ Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚: SRID 4326 (WGS84)

**SRID 4326** = ÑÐ¸ÑÑ‚ÐµÐ¼Ð° ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚ **WGS84** - ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚ Ð´Ð»Ñ GPS Ð¸ Ð²ÐµÐ±-ÐºÐ°Ñ€Ñ‚.

**Ð¥Ð°Ñ€Ð°ÐºÑ‚ÐµÑ€Ð¸ÑÑ‚Ð¸ÐºÐ¸:**
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ GPS, Google Maps, OpenStreetMap
- ÐšÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚Ñ‹ Ð² Ð³Ñ€Ð°Ð´ÑƒÑÐ°Ñ… (ÑˆÐ¸Ñ€Ð¾Ñ‚Ð°: -90 Ð´Ð¾ +90, Ð´Ð¾Ð»Ð³Ð¾Ñ‚Ð°: -180 Ð´Ð¾ +180)
- Ð Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð¸Ð·Ð¼ÐµÑ€ÑÑŽÑ‚ÑÑ Ð² Ð³Ñ€Ð°Ð´ÑƒÑÐ°Ñ…, Ð° Ð½Ðµ Ð¼ÐµÑ‚Ñ€Ð°Ñ…

**ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ 4326:**
- âœ… Ð£Ð½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ - Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð´Ð»Ñ Ð²ÑÐµÐ³Ð¾ Ð¼Ð¸Ñ€Ð°
- âœ… Ð¡Ð¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ñ Ð±Ð¾Ð»ÑŒÑˆÐ¸Ð½ÑÑ‚Ð²Ð¾Ð¼ ÐºÐ°Ñ€Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… ÑÐµÑ€Ð²Ð¸ÑÐ¾Ð²
- âœ… ÐŸÑ€Ð¾ÑÑ‚Ð¾Ñ‚Ð° Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸Ð· Ð²Ð½ÐµÑˆÐ½Ð¸Ñ… Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ¾Ð²

---

### ðŸ” ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð³ÐµÐ¾Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸ PostGIS

#### 1. **ST_Within** - ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð²Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð² Ð¿Ð¾Ð»Ð¸Ð³Ð¾Ð½

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ð¿Ð¾Ð¿Ð°Ð´Ð°Ð½Ð¸Ñ Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð² ÑÐµÐºÑ‚Ð¾Ñ€Ñ‹.

**SQL Ð¿Ñ€Ð¸Ð¼ÐµÑ€:**
```sql
SELECT dp.id, dp.name, s.name as sector_name
FROM delivery_points dp
JOIN sectors s ON ST_Within(dp.location, s.boundary)
WHERE s.region_id = 1;
```

**Python (SQLAlchemy):**
```python
from sqlalchemy import func, select

query = select(DeliveryPoint, Sector).join(
    Sector,
    func.ST_Within(DeliveryPoint.location, Sector.boundary)
).where(Sector.region_id == 1)
```

**ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ:**
- ÐšÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ ÐºÐ°ÐºÐ¸Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð¿Ð¾Ð¿Ð°Ð´Ð°ÑŽÑ‚ Ð² ÑÐµÐºÑ‚Ð¾Ñ€Ñ‹ Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð°
- ÐŸÐ¾Ð¸ÑÐº Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð²

---

#### 2. **ST_Distance** - Ð Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð¼ÐµÐ¶Ð´Ñƒ Ñ‚Ð¾Ñ‡ÐºÐ°Ð¼Ð¸

Ð Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð¼ÐµÐ¶Ð´Ñƒ Ð´Ð²ÑƒÐ¼Ñ Ñ‚Ð¾Ñ‡ÐºÐ°Ð¼Ð¸ Ð² Ð³Ñ€Ð°Ð´ÑƒÑÐ°Ñ….

**SQL Ð¿Ñ€Ð¸Ð¼ÐµÑ€:**
```sql
SELECT 
    dc.name,
    ST_Distance(
        ST_SetSRID(ST_MakePoint(39.723098, 43.585472), 4326),
        dc.location
    ) as distance_degrees
FROM distribution_centers dc
ORDER BY distance_degrees
LIMIT 1;
```

**âš ï¸ Ð’Ð°Ð¶Ð½Ð¾:** `ST_Distance` Ð² SRID 4326 Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð² **Ð³Ñ€Ð°Ð´ÑƒÑÐ°Ñ…**, Ð° Ð½Ðµ ÐºÐ¸Ð»Ð¾Ð¼ÐµÑ‚Ñ€Ð°Ñ…!

**Ð”Ð»Ñ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð² Ð¼ÐµÑ‚Ñ€Ð°Ñ…/ÐºÐ¸Ð»Ð¾Ð¼ÐµÑ‚Ñ€Ð°Ñ…:**
```sql
-- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ST_Distance Ñ Ð³ÐµÐ¾Ð³Ñ€Ð°Ñ„Ð¸ÐµÐ¹
SELECT 
    ST_Distance(
        geography(ST_SetSRID(ST_MakePoint(39.723098, 43.585472), 4326)),
        geography(dc.location)
    ) / 1000 as distance_km
FROM distribution_centers dc;
```

**Ð’ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ñ„Ð¾Ñ€Ð¼ÑƒÐ»Ð° Haversine** (Python) Ð´Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° Ð¿Ñ€ÑÐ¼Ð¾Ð³Ð¾ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð² ÐºÐ¼.

---

#### 3. **ST_MakeEnvelope** - Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ñ€ÑÐ¼Ð¾ÑƒÐ³Ð¾Ð»ÑŒÐ½Ð¸ÐºÐ° (Bounding Box)

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ð´Ð»Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ñ‚Ð¾Ñ‡ÐµÐº Ð¿Ð¾ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ð²Ð°ÑŽÑ‰ÐµÐ¼Ñƒ Ð¿Ñ€ÑÐ¼Ð¾ÑƒÐ³Ð¾Ð»ÑŒÐ½Ð¸ÐºÑƒ.

**SQL Ð¿Ñ€Ð¸Ð¼ÐµÑ€:**
```sql
SELECT dp.*
FROM delivery_points dp
WHERE ST_Within(
    dp.location,
    ST_MakeEnvelope(39.7, 43.5, 39.8, 43.6, 4326)
);
-- min_lng, min_lat, max_lng, max_lat, SRID
```

**Python (SQLAlchemy):**
```python
from geoalchemy2.functions import ST_MakeEnvelope, ST_Within

bbox_polygon = ST_MakeEnvelope(
    filters.bbox.min_lng,
    filters.bbox.min_lat,
    filters.bbox.max_lng,
    filters.bbox.max_lat,
    4326
)
query = query.where(ST_Within(DeliveryPoint.location, bbox_polygon))
```

**ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ:** ÐŸÐ¾Ð¸ÑÐº Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð² Ð²Ð¸Ð´Ð¸Ð¼Ð¾Ð¹ Ð¾Ð±Ð»Ð°ÑÑ‚Ð¸ ÐºÐ°Ñ€Ñ‚Ñ‹.

---

#### 4. **ST_AsGeoJSON** - ÐšÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð°Ñ†Ð¸Ñ Ð² GeoJSON

ÐŸÑ€ÐµÐ¾Ð±Ñ€Ð°Ð·ÑƒÐµÑ‚ PostGIS Ð³ÐµÐ¾Ð¼ÐµÑ‚Ñ€Ð¸ÑŽ Ð² GeoJSON Ð´Ð»Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ ÐºÐ»Ð¸ÐµÐ½Ñ‚Ñƒ.

**SQL Ð¿Ñ€Ð¸Ð¼ÐµÑ€:**
```sql
SELECT 
    id,
    name,
    ST_AsGeoJSON(location) as location_geojson
FROM delivery_points;
```

**Python (SQLAlchemy):**
```python
from geoalchemy2.functions import ST_AsGeoJSON

query = select(
    DeliveryPoint.id,
    DeliveryPoint.name,
    ST_AsGeoJSON(DeliveryPoint.location).label('location_geojson')
)

# Ð’ ÐºÐ¾Ð´Ðµ
import json
location_data = json.loads(row.location_geojson)
# {'type': 'Point', 'coordinates': [39.723098, 43.585472]}
```

---

### âš¡ ÐŸÑ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð¸Ð½Ð´ÐµÐºÑÑ‹

Ð’ÑÐµ Ð³ÐµÐ¾Ð¼ÐµÑ‚Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¿Ð¾Ð»Ñ Ð¸Ð¼ÐµÑŽÑ‚ **GIST Ð¸Ð½Ð´ÐµÐºÑÑ‹** Ð´Ð»Ñ Ð±Ñ‹ÑÑ‚Ñ€Ñ‹Ñ… Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð².

**ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· GeoAlchemy2:**
```python
location: Mapped[str] = mapped_column(
    Geometry(geometry_type='POINT', srid=4326, spatial_index=True),
    nullable=False
)
```

**SQL ÑÐºÐ²Ð¸Ð²Ð°Ð»ÐµÐ½Ñ‚:**
```sql
CREATE INDEX idx_delivery_points_location 
ON delivery_points 
USING GIST (location);
```

**ÐŸÑ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð°:**
- âœ… Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº Ñ‚Ð¾Ñ‡ÐµÐº Ð² Ñ€Ð°Ð´Ð¸ÑƒÑÐµ
- âœ… Ð­Ñ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð²Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ Ð² Ð¿Ð¾Ð»Ð¸Ð³Ð¾Ð½
- âœ… Ð‘Ñ‹ÑÑ‚Ñ€Ð°Ñ ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ° Ð¿Ð¾ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸ÑŽ

**Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð±ÐµÐ· Ð¸Ð½Ð´ÐµÐºÑÐ°:** O(n) - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð²ÑÐµÑ… Ð·Ð°Ð¿Ð¸ÑÐµÐ¹  
**Ð¡Ð»Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ñ Ð¸Ð½Ð´ÐµÐºÑÐ¾Ð¼:** O(log n) - Ð±Ð¸Ð½Ð°Ñ€Ð½Ñ‹Ð¹ Ð¿Ð¾Ð¸ÑÐº Ð¿Ð¾ Ð´ÐµÑ€ÐµÐ²Ñƒ

---

### ðŸ“ Ð Ð°ÑÑ‡ÐµÑ‚ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ð¹ Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ

#### ÐœÐµÑ‚Ð¾Ð´ 1: **Ð¤Ð¾Ñ€Ð¼ÑƒÐ»Ð° Haversine** (Ð¿Ñ€ÑÐ¼Ð¾Ðµ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ)

Ð Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ "Ð¿Ð¾ Ð¿Ñ€ÑÐ¼Ð¾Ð¹" Ð¼ÐµÐ¶Ð´Ñƒ Ð´Ð²ÑƒÐ¼Ñ Ñ‚Ð¾Ñ‡ÐºÐ°Ð¼Ð¸ Ð½Ð° ÑÑ„ÐµÑ€Ðµ (Ð—ÐµÐ¼Ð»Ðµ).

**Ð ÐµÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð² Python:**
```python
import math

def haversine_distance(lat1, lon1, lat2, lon2):
    """Ð Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð² ÐºÐ¸Ð»Ð¾Ð¼ÐµÑ‚Ñ€Ð°Ñ…."""
    lat1_rad = math.radians(lat1)
    lon1_rad = math.radians(lon1)
    lat2_rad = math.radians(lat2)
    lon2_rad = math.radians(lon2)
    
    dlat = lat2_rad - lat1_rad
    dlon = lon2_rad - lon1_rad
    
    a = (math.sin(dlat / 2) ** 2 + 
         math.cos(lat1_rad) * math.cos(lat2_rad) * 
         math.sin(dlon / 2) ** 2)
    c = 2 * math.asin(math.sqrt(a))
    
    earth_radius = 6371.0  # ÐºÐ¼
    return earth_radius * c
```

**Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ:**
- Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ Ð¿Ñ€ÐµÐ´Ð²Ð°Ñ€Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð¾Ñ‚Ð±Ð¾Ñ€ Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ñ… Ð Ð¦
- Fallback ÐµÑÐ»Ð¸ API Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½

---

#### ÐœÐµÑ‚Ð¾Ð´ 2: **OpenRouteService API** (Ð´Ð¾Ñ€Ð¾Ð¶Ð½Ð¾Ðµ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ)

Ð Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ðµ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ð¿Ð¾ Ð´Ð¾Ñ€Ð¾Ð³Ð°Ð¼.

**ÐžÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸:**
- âœ… Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð´Ð¾Ñ€Ð¾Ð³Ð¸, Ð¿Ð¾Ð²Ð¾Ñ€Ð¾Ñ‚Ñ‹, Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ
- âœ… Ð¢Ð¾Ñ‡Ð½ÐµÐµ Ð´Ð»Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚Ð¸ Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸
- âŒ Ð¢Ñ€ÐµÐ±ÑƒÐµÑ‚ Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚ Ð¸ API ÐºÐ»ÑŽÑ‡
- âŒ Ð›Ð¸Ð¼Ð¸Ñ‚Ñ‹ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð² (2000/Ð´ÐµÐ½ÑŒ Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾)

**Ð¡Ñ‚Ñ€Ð°Ñ‚ÐµÐ³Ð¸Ñ Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ:**
1. Haversine Ð´Ð»Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ñ‚Ð¾Ð¿-3 Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ñ… Ð Ð¦
2. OpenRouteService API Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ Ñ‚Ð¾Ð¿-3
3. Ð•ÑÐ»Ð¸ API Ð½ÐµÐ´Ð¾ÑÑ‚ÑƒÐ¿ÐµÐ½ â†’ ÐºÐ¾ÑÑ„Ñ„Ð¸Ñ†Ð¸ÐµÐ½Ñ‚ 1.4 Ðº Ð¿Ñ€ÑÐ¼Ð¾Ð¼Ñƒ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸ÑŽ

---

### ðŸ›  Ð Ð°Ð±Ð¾Ñ‚Ð° Ñ Ð³ÐµÐ¾Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸ Ð² ÐºÐ¾Ð´Ðµ

#### Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð¸Ð· ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚

**Python (GeoAlchemy2):**
```python
from geoalchemy2.shape import from_shape
from shapely.geometry import Point

# Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸
point = Point(39.723098, 43.585472)  # lon, lat

# ÐšÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð°Ñ†Ð¸Ñ Ð´Ð»Ñ SQLAlchemy
from_shape(point, srid=4326)
```

#### Ð˜Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ðµ ÐºÐ¾Ð¾Ñ€Ð´Ð¸Ð½Ð°Ñ‚ Ð¸Ð· Ð‘Ð”

**Python:**
```python
from geoalchemy2.shape import to_shape

# Ð˜Ð· Ð‘Ð”
delivery_point = await db.get(DeliveryPoint, 1)

# ÐšÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð°Ñ†Ð¸Ñ Ð² Shapely
shape = to_shape(delivery_point.location)

latitude = shape.y
longitude = shape.x
```

#### Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¿Ð¾Ð»Ð¸Ð³Ð¾Ð½Ð° Ð¸Ð· GeoJSON

**Python:**
```python
from shapely.geometry import shape as shapely_shape
from geoalchemy2.shape import from_shape
import json

# GeoJSON Ð´Ð°Ð½Ð½Ñ‹Ðµ
geojson_data = {
    "type": "Polygon",
    "coordinates": [[[39.7, 43.5], [39.8, 43.5], [39.8, 43.6], [39.7, 43.5]]]
}

# ÐšÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð°Ñ†Ð¸Ñ
polygon = shapely_shape(geojson_data)
geoalchemy_polygon = from_shape(polygon, srid=4326)

# Ð¡Ð¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð² Ð‘Ð”
sector = Sector(
    region_id=1,
    name="Ð¡ÐµÐºÑ‚Ð¾Ñ€ 1",
    boundary=geoalchemy_polygon
)
```

---

### ðŸ“Š ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ

#### 1. ÐŸÐ¾Ð¸ÑÐº Ñ‚Ð¾Ñ‡ÐµÐº Ð´Ð¾ÑÑ‚Ð°Ð²ÐºÐ¸ Ð² ÑÐµÐºÑ‚Ð¾Ñ€Ð°Ñ…

```python
from sqlalchemy import select, func, and_

# Ð¢Ð¾Ñ‡ÐºÐ¸ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ñ€ÐµÐ³Ð¸Ð¾Ð½Ð°
query = select(DeliveryPoint, Sector).join(
    Sector,
    func.ST_Within(DeliveryPoint.location, Sector.boundary)
).where(
    and_(
        Sector.region_id == region_id,
        DeliveryPoint.is_active == True
    )
)

result = await db.execute(query)
```

#### 2. ÐŸÐ¾Ð¸ÑÐº Ñ‚Ð¾Ñ‡ÐµÐº Ð² bounding box

```python
from geoalchemy2.functions import ST_MakeEnvelope, ST_Within

bbox_polygon = ST_MakeEnvelope(
    min_lng, min_lat, max_lng, max_lat, 4326
)

query = select(DeliveryPoint).where(
    ST_Within(DeliveryPoint.location, bbox_polygon)
)
```

#### 3. ÐŸÐ¾Ð¸ÑÐº Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐµÐ³Ð¾ Ð Ð¦

```python
# 1. Ð‘Ñ‹ÑÑ‚Ñ€Ñ‹Ð¹ Ð¾Ñ‚Ð±Ð¾Ñ€ Ñ‡ÐµÑ€ÐµÐ· Haversine
dc_distances = []
for dc in distribution_centers:
    dc_lat, dc_lon = extract_coordinates(dc.location)
    distance = haversine_distance(supplier_lat, supplier_lon, dc_lat, dc_lon)
    dc_distances.append((dc, distance))

# Ð¢Ð¾Ð¿-3 Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ñ…
top_3 = sorted(dc_distances, key=lambda x: x[1])[:3]

# 2. Ð¢Ð¾Ñ‡Ð½Ð¾Ðµ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· OpenRouteService API
for dc, _ in top_3:
    road_distance = await get_route_distance(supplier, dc)
```

---

### ðŸŽ¯ ÐŸÑ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ PostGIS

âœ… **ÐŸÑ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ** - Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð¸Ð½Ð´ÐµÐºÑÑ‹ ÑƒÑÐºÐ¾Ñ€ÑÑŽÑ‚ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ð² ÑÐ¾Ñ‚Ð½Ð¸ Ñ€Ð°Ð·  
âœ… **Ð¢Ð¾Ñ‡Ð½Ð¾ÑÑ‚ÑŒ** - Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð³ÐµÐ¾Ð¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ð°Ð»Ð³Ð¾Ñ€Ð¸Ñ‚Ð¼Ñ‹  
âœ… **Ð¡Ñ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ñ** - ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ñ GeoJSON, WKT, WKB  
âœ… **Ð Ð°ÑÑˆÐ¸Ñ€ÑÐµÐ¼Ð¾ÑÑ‚ÑŒ** - ÑÐ¾Ñ‚Ð½Ð¸ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¹ Ð´Ð»Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ Ñ Ð³ÐµÐ¾Ð¼ÐµÑ‚Ñ€Ð¸ÐµÐ¹  
âœ… **Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ** - Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð²Ð½ÑƒÑ‚Ñ€Ð¸ PostgreSQL, Ð½Ðµ Ð½ÑƒÐ¶Ð½Ñ‹ Ð²Ð½ÐµÑˆÐ½Ð¸Ðµ ÑÐµÑ€Ð²Ð¸ÑÑ‹  

---

### ðŸ”— ÐŸÐ¾Ð»ÐµÐ·Ð½Ñ‹Ðµ ÑÑÑ‹Ð»ÐºÐ¸

- [PostGIS Documentation](https://postgis.net/documentation/)
- [GeoAlchemy2 Documentation](https://geoalchemy-2.readthedocs.io/)
- [Shapely Documentation](https://shapely.readthedocs.io/)
- [GeoJSON Specification](https://geojson.org/)
- [geojson.io](https://geojson.io/) - Ð²Ð¸Ð·ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¾Ñ€ GeoJSON

---

_Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ Ð±ÑƒÐ´ÐµÑ‚ Ð´Ð¾Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒÑÑ Ð¿Ð¾ Ð¼ÐµÑ€Ðµ Ñ€Ð°Ð·Ð²Ð¸Ñ‚Ð¸Ñ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°._

